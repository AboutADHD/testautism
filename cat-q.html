<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chestionarul CAT-Q (Camouflaging Autistic Traits Questionnaire)</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- FontAwesome CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style type="text/css">
html {
    scroll-behavior: smooth;
}

body {
    font-family: Arial, sans-serif;
    margin: 20px;
}

.partner-logos {
    padding: 20px 0;
}

.partner-logos img {
    transition: transform 0.2s ease;
}

.partner-logos img:hover {
    transform: scale(1.05);
}

.highlight-unanswered {
    background-color: beige !important;
}

.progress-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background: white;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    padding: 1rem;
    transform: translateY(-100%);
    transition: transform 0.3s ease;
    pointer-events: none;
    visibility: hidden;
}

.progress-container.visible {
    transform: translateY(0);
    pointer-events: auto;
    visibility: visible;
}

.progress-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.progress-bar {
    width: 100%;
    height: 12px;
    background: #f0f0f0;
    border-radius: 6px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #2196F3, #64B5F6);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-message {
    text-align: center;
    margin-top: 0.5rem;
    color: #333;
    font-weight: 500;
    transition: all 0.3s ease;
    animation: messagePopIn 0.5s ease;
}

.question {
    margin-bottom: 2rem;
    padding: 1.5rem;
    border-radius: 8px;
    background-color: white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    border-left: 3px solid transparent;
    transition: all 0.3s ease;
}

.question.current {
    border-left-color: #2196F3;
    background-color: #f8f9fa;
}

.question.completed::after {
    content: '✓';
    color: #4CAF50;
    position: absolute;
    right: 1rem;
    top: 1rem;
}

.question-text {
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    color: #2c3e50;
    font-weight: 500;
    padding: 0.8rem;
    border-radius: 8px;
    background-color: #f8f9fa;
}

.form-check {
    margin-bottom: 1rem;
    padding: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    min-height: 3.5rem;
}

.form-check:hover {
    background-color: #f5f9ff;
    border-color: #90caf9;
}

.form-check-input {
    width: 24px;
    height: 24px;
    margin-right: 12px;
    cursor: pointer;
}

.form-check-label {
    font-size: 1.1rem;
    padding: 0.5rem;
    color: #455a64;
    cursor: pointer;
    user-select: none;
    flex: 1;
}

.help-button {
    color: #666;
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s ease;
    border: none;
    background: none;
    border-radius: 4px;
}

.help-button:hover {
    color: #2196F3;
    background-color: rgba(33, 150, 243, 0.1);
}

.help-content {
    max-height: 0;
    overflow: hidden;
    transition: all 0.3s ease-out;
    opacity: 0;
    margin-top: 0;
}

.help-content:not([hidden]) {
    max-height: 200px;
    opacity: 1;
    margin-top: 1rem;
}

.action-btn {
    transition: all 0.3s ease;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 12px 24px;
    margin-bottom: 1rem;
    width: 100%;
    border: none;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.calculate-btn {
    background: linear-gradient(45deg, #2196F3, #1976D2);
    color: white;
}

.btn-loading {
    position: relative;
    color: transparent !important;
}

.btn-loading:after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    top: 50%;
    left: 50%;
    margin: -10px 0 0 -10px;
    border: 3px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Results styling */
.result-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
}

.score-section {
    margin: 1.5rem 0;
    padding: 1.5rem;
    border-radius: 8px;
    background: #f8f9fa;
}

.score-label {
    font-size: 1.1rem;
    color: #2196F3;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.score-value {
    font-size: 2rem;
    font-weight: bold;
    color: #1976D2;
}

.score-bar {
    margin: 1rem 0;
    height: 12px;
    background: #e9ecef;
    border-radius: 6px;
    overflow: hidden;
    position: relative;
}

.score-fill {
    height: 100%;
    transition: width 0.6s ease;
}

.threshold-marker {
    position: absolute;
    top: 0;
    height: 100%;
    width: 2px;
    background: rgba(0,0,0,0.5);
}

@keyframes messagePopIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

@media (max-width: 768px) {
    body {
        margin: 10px;
    }

    .question {
        padding: 1rem;
    }

    .form-check {
        padding: 0.8rem;
        min-height: 3rem;
    }

    .form-check-label {
        font-size: 1rem;
    }
}

/* Add to your existing styles */

.partner-logos img {
    transition: transform 0.2s ease;
}

.partner-logos img:hover {
    transform: scale(1.05);
}

.feature-card {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: transform 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.feature-icon {
    width: 48px;
    height: 48px;
    margin-bottom: 1rem;
    background-color: rgba(33, 150, 243, 0.1);
    border-radius: 50%;
}

.feature-title {
    font-size: 1.25rem;
    color: #2196F3;
    margin-bottom: 1rem;
}

.feature-note {
    font-size: 0.9rem;
    color: #666;
    font-style: italic;
}

.privacy-item {
    margin-bottom: 0.5rem;
    color: #555;
    font-size: 0.95rem;
}

.privacy-item:before {
    content: '✓';
    color: #4CAF50;
    margin-right: 0.5rem;
}

.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.pdf-container {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 0 auto;
    background-color: white;
}

.pdf-container h1 {
    color: #2196F3;
    font-size: 24px;
    text-align: center;
    margin-bottom: 20px;
}

.pdf-container .disclaimer {
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 4px;
}

.pdf-container .score-section {
    background-color: #f8f9fa;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 4px;
}

.pdf-container .progress-bar {
    background-color: #e9ecef;
    height: 12px;
    border-radius: 6px;
    overflow: hidden;
    position: relative;
    margin: 10px 0;
}

.pdf-container .progress-fill {
    height: 100%;
    transition: width 0.6s ease;
}

.pdf-container .threshold-marker {
    position: absolute;
    top: 0;
    height: 100%;
    width: 2px;
    background-color: rgba(0,0,0,0.5);
}

.pdf-container .score-value {
    font-size: 20px;
    font-weight: bold;
    color: #1976D2;
}

.pdf-container .score-label {
    color: #2196F3;
    font-weight: bold;
    margin-bottom: 5px;
}

.pdf-container .interpretation {
    background-color: #e8f4f8;
    padding: 15px;
    margin: 20px 0;
    border-radius: 4px;
}

.pdf-container .answers-section {
    margin-top: 20px;
}

.pdf-container .answer-item {
    background-color: #f8f9fa;
    padding: 8px;
    margin-bottom: 8px;
    border-radius: 4px;
    font-size: 12px;
}

@media print {
    .pdf-container {
        margin: 0;
        padding: 20px;
    }
}

.alert-danger .alert-heading {
    color: #721c24;
    font-weight: bold;
}

.alert-danger {
    cursor: pointer;
}

.alert-danger:hover {
    background-color: #f8d7da;
}
</style>
</head>
<body>
<div class="container" id="main-content">
    <!-- Skip to content link for keyboard users -->
    <a href="#main-content" class="sr-only sr-only-focusable">Sari la conținut</a>

    <!-- Quick navigation bar -->
    <div id="quick-nav" class="quick-nav-container">
        <ul class="quick-nav">
            <li>
                <a href="index.html" class="quick-nav-item">
                    <i class="fas fa-home"></i>
                    <span>RAADS-R Test</span>
                </a>
            </li>
            <li>
                <a href="#section-faq" class="quick-nav-item">
                    <i class="fas fa-info-circle"></i>
                    <span>Despre CAT-Q</span>
                </a>
            </li>
            <li>
                <a href="#section-instructions" class="quick-nav-item">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Componența testului</span>
                </a>
            </li>
            <li>
                <a href="#section-quiz" class="quick-nav-item">
                    <i class="fa-solid fa-circle-play"></i>
                    <span>Testul CAT-Q - ÎNCEPE AICI!</span>
                </a>
            </li>
            <li>
                <a href="#section-results" class="quick-nav-item">
                    <i class="fas fa-chart-line"></i>
                    <span>Rezultate</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="initial-section justify-content-center">
        <div class="d-flex align-items-center mb-3">
            <a href="index.html" class="btn btn-outline-primary me-3" style="border-radius: 20px; padding: 6px 15px;">
                <i class="fas fa-arrow-left me-1"></i> RAADS-R Test
            </a>
            <h1 class="text-center mb-0" style="font-size: 1.5rem; font-weight: bold;">Test de Evaluare a Camuflării Sociale: CAT-Q (Camouflaging Autistic Traits Questionnaire)</h1>
        </div>
        <h2 class="text-center mb-3" style="font-size: 1.3rem; color: #1976D2;">Cum măsurăm masking-ul și camuflarea trăsăturilor autiste la adulți</h2>

        <div class="empathetic-intro">
            <p>Ai observat vreodată că depui efort semnificativ pentru a părea "normal" în situații sociale? Poate ai dezvoltat strategii complexe pentru a ascunde anumite comportamente sau pentru a te adapta mediilor sociale. Aceste strategii sunt cunoscute sub numele de camuflare sau "masking".</p>
        </div>

        <div class="card border-primary mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0 h4">Chestionarul CAT-Q (Revizuit)</h3>
            </div>
            <div class="card-body">
                <p><strong>Chestionarul pentru Camuflarea Trăsăturilor Autiste</strong> (CAT-Q) este destinat adulților cu vârsta de peste 16 ani și cu inteligență medie sau superioară. Scopul testului este de a măsura gradul în care persoanele folosesc strategii de camuflare în interacțiunile sociale.</p>

                <p><strong>Camuflarea</strong> este procesul prin care persoanele autiste își ascund sau ajustează trăsăturile autiste pentru a evita stigmatizarea sau pentru a se integra mai ușor în societate.</p>

                <div class="alert alert-info mt-3">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-info-circle fa-2x text-primary"></i>
                        </div>
                        <div>
                            <h4 class="alert-heading">Știai că?</h4>
                            <p class="mb-0">Camuflarea socială este o strategie folosită de multe persoane autiste pentru a-și ascunde trăsăturile autiste în interacțiunile sociale. Deși poate ajuta temporar la integrare, pe termen lung camuflarea constantă poate duce la epuizare, anxietate, depresie și burnout autist.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <h3 class="card-title h4"><i class="fas fa-mask text-primary me-2"></i>Ce este CAT-Q?</h3>
                        <p class="card-text">CAT-Q (Camouflaging Autistic Traits Questionnaire) este un instrument de evaluare a camuflării sociale dezvoltat de Dr. Laura Hull și colegii de la University College London. Acesta măsoară trei aspecte principale ale camuflării:</p>
                        <ul>
                            <li><strong>Compensare</strong> - strategii pentru a depăși dificultățile sociale</li>
                            <li><strong>Masking</strong> - suprimarea comportamentelor autiste naturale</li>
                            <li><strong>Asimilare</strong> - tehnici pentru a părea "normal" în interacțiunile sociale</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <h3 class="card-title h4"><i class="fas fa-puzzle-piece text-success me-2"></i>Cum completează RAADS-R?</h3>
                        <p class="card-text">În timp ce testul RAADS-R evaluează prezența trăsăturilor autiste, CAT-Q se concentrează pe strategiile pe care le folosești pentru a masca aceste trăsături. Împreună, cele două teste oferă o imagine mai completă a experienței autiste:</p>
                        <div class="d-flex justify-content-between mt-3">
                            <div class="text-center px-2">
                                <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 50px; height: 50px;">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <p class="small"><strong>RAADS-R</strong><br/>Evaluează trăsăturile autiste</p>
                            </div>
                            <div class="text-center px-2">
                                <div class="d-flex align-items-center justify-content-center my-2">
                                    <i class="fas fa-plus text-muted"></i>
                                </div>
                                <p class="small">&nbsp;</p>
                            </div>
                            <div class="text-center px-2">
                                <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 50px; height: 50px;">
                                    <i class="fas fa-mask"></i>
                                </div>
                                <p class="small"><strong>CAT-Q</strong><br/>Măsoară camuflarea socială</p>
                            </div>
                            <div class="text-center px-2">
                                <div class="d-flex align-items-center justify-content-center my-2">
                                    <i class="fas fa-equals text-muted"></i>
                                </div>
                                <p class="small">&nbsp;</p>
                            </div>
                            <div class="text-center px-2">
                                <div class="rounded-circle bg-info text-white d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 50px; height: 50px;">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <p class="small"><strong>Imagine completă</strong><br/>Înțelegere holistică</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mb-4 border-0 shadow" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-2 text-center mb-3 mb-md-0">
                        <i class="fas fa-lightbulb fa-4x text-warning"></i>
                    </div>
                    <div class="col-md-10">
                        <h3 class="h4 mb-3">De ce este important să înțelegi camuflarea?</h3>
                        <p>Camuflarea este o experiență comună pentru multe persoane autiste, în special pentru femei și persoane diagnosticate târziu. Măsurarea camuflării poate:</p>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="mb-0">
                                    <li>Explica de ce unele persoane autiste "scapă de sub radar" mult timp</li>
                                    <li>Ajuta la înțelegerea burnout-ului autist și epuizării</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="mb-0">
                                    <li>Facilita identificarea strategiilor care te pot epuiza</li>
                                    <li>Contribui la dezvoltarea unui stil de viață mai autentic</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="cta-button-wrapper">
            <div class="cta-emphasis">
                <a id="start-test" href="#first-disclaimer" class="cta-button pulse">
                    <i class="fas fa-clipboard-list"></i>
                    Mergi direct la Testul CAT-Q
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>

        <!-- Partners section - same as in index.html -->
        <div class="mt-4">
            Website realizat cu 💖 de către <b>Andrei Hodorog</b> și <b>Ovidiu Platon</b>. Parteneri:
            <div class="partner-logos">
                <div class="container">
                    <div class="row justify-content-center align-items-center g-4">
                        <div class="col-12 col-md-4">
                            <a href="https://www.ovidiuplaton.com" target="_blank" class="d-block text-center">
                                <img src="https://www.ovidiuplaton.com/content/images/2024/07/ovidiu-platon---consilier-autism-adhd--audhd.png"
                                     class="img-fluid"
                                     style="max-width: 300px; max-height: 100px; aspect-ratio: 3/1; width: auto;"
                                     alt="Ovidiu Platon - Consilier Parental si de Dezvoltare Personala - autism ADHD"/>
                            </a>
                        </div>
                        <div class="col-12 col-md-4">
                            <a href="https://www.suntautist.ro" target="_blank" class="d-block text-center">
                                <img src="https://www.doctoradhd.com/wp-content/uploads/2023/08/suntautist-logo-1024x385.png"
                                     class="img-fluid"
                                     style="max-width: 300px; max-height: 100px; aspect-ratio: 8/3; width: auto;"
                                     alt="Asociatia Sunt Autist - Autismul explicat de autisti"/>
                            </a>
                        </div>
                        <div class="col-12 col-md-4">
                            <a href="https://www.despreadhd.ro" target="_blank" class="d-block text-center">
                                <img src="https://www.despreadhd.ro/content/images/2024/10/despreadhd-ro.jpg"
                                     class="img-fluid"
                                     style="max-width: 300px; max-height: 100px; aspect-ratio: 4/3; width: auto;"
                                     alt="About ADHD România - Știință, diagnostic, tratament, suport"/>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-2">
            <b>Grupuri de suport:</b>
            <i class="fa-brands fa-facebook"></i> <a href="https://fb.com/groups/suntautist" target="_blank" rel="nofollow">
                Autismul explicat de autiști
            </a>
            &nbsp;|&nbsp;
            <i class="fa-brands fa-facebook"></i> <a href="https://fb.com/groups/aboutadhd" target="_blank" rel="nofollow">
                About ADHD România - Informații științifice, diagnostic, tratament
            </a>
        </div>
        <hr>
    </div>

    <!-- Disclaimer Section -->
    <div id="first-disclaimer" class="alert alert-warning alert-dismissible fade show mb-4" role="alert">
        <h2 class="alert-heading h3 mb-3">Avertisment <strong>IMPORTANT</strong> și <strong>Disclaimer</strong> - <strong>Citește ÎNAINTE</strong> de a începe testul!</h2>
        <p>
            Acest test este destinat <b>EXCLUSIV</b> în scop informativ și <b>NU</b> trebuie utilizat ca un instrument de diagnostic. Deși testul CAT-Q a fost validat științific pentru măsurarea camuflării sociale, el <b>NU</b> înlocuiește o evaluare profesională efectuată de un specialist în domeniul sănătății mintale.
        </p>

        <p>Scorurile ridicate la CAT-Q pot indica prezența unor strategii de camuflare utilizate frecvent de persoanele autiste, dar nu reprezintă în sine un diagnostic de autism. Camuflarea socială poate fi prezentă și în alte condiții precum anxietatea socială.</p>

        <p>Pentru evaluări profesionale și diagnostic, vă recomandăm să vizitați <a href="https://www.doctoradhd.com/" target="_blank">doctoradhd.com</a>.</p>
        <p>
            Vă încurajăm să folosiți rezultatele în mod <strong>responsabil</strong> și să căutați <b>suport profesional calificat, de specialitate</b> dacă aveți nevoie de o evaluare detaliată.
        </p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <!-- CAT-Q Features Section -->
    <div class="features-container">
        <h2 class="text-center mb-4"><i class="fas fa-question-circle text-primary me-2"></i>Ce măsoară testul CAT-Q?</h2>
        <div class="row g-4">
            <!-- Compensation Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-cogs text-primary fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Compensare</h3>
                    <p class="feature-text">
                        Strategii explicite pentru a depăși dificultățile sociale și de comunicare.
                        <ul class="list-unstyled mt-3">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Planificarea conversațiilor în avans</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Memorarea regulilor sociale</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Imitarea comportamentelor altora</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Monitorizarea atentă a reacțiilor celorlalți</li>
                        </ul>
                    </p>
                </div>
            </div>

            <!-- Masking Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-mask text-danger fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Masking</h3>
                    <p class="feature-text">
                        Suprimarea comportamentelor autiste naturale pentru a evita stigmatizarea.
                        <ul class="list-unstyled mt-3">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Inhibarea stimming-ului</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Controlul expresiilor faciale</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Ascunderea intereselor speciale</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Forțarea contactului vizual</li>
                        </ul>
                    </p>
                </div>
            </div>

            <!-- Assimilation Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-users text-success fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Asimilare</h3>
                    <p class="feature-text">
                        Tehnici pentru a părea "neurotypical" și a se integra social.
                        <ul class="list-unstyled mt-3">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Copierea frazelor și gesturilor</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Reproducerea tonului și inflexiunilor</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Pretinderea interesului pentru subiecte populare</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Adaptarea comportamentului la context</li>
                        </ul>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Test structure explanation -->
    <div class="card mb-4 mt-5 border-0 shadow-sm">
        <div class="card-header bg-white py-3">
            <h2 class="card-title h4 mb-0"><i class="fas fa-clipboard-list text-primary me-2"></i>Cum funcționează testul CAT-Q?</h2>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h3 class="h5 mb-3">Despre test</h3>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-file-alt text-primary me-3"></i>
                            <span><strong>Număr de întrebări:</strong> 25 de afirmații</span>
                        </li>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-clock text-warning me-3"></i>
                            <span><strong>Timp estimat:</strong> 5-10 minute</span>
                        </li>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-chart-bar text-success me-3"></i>
                            <span><strong>Scală de evaluare:</strong> De la 1 (Dezacord puternic) la 7 (Acord puternic)</span>
                        </li>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-layer-group text-info me-3"></i>
                            <span><strong>Distribuția întrebărilor:</strong> 9 pentru Compensare, 8 pentru Mascare, 8 pentru Asimilare</span>
                        </li>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-users text-info me-3"></i>
                            <span><strong>Autori:</strong> Dr. Laura Hull et al., University College London</span>
                        </li>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="fas fa-calendar-alt text-danger me-3"></i>
                            <span><strong>Publicat în:</strong> 2019</span>
                        </li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h3 class="h5 mb-3">Despre scoruri</h3>
                    <div class="alert alert-info">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-chart-line fa-2x me-3 text-primary"></i>
                            <div>
                                <h5 class="alert-heading m-0">Scor total</h5>
                                <p class="mb-0 mt-1">Variază între <strong>25 și 175 de puncte</strong>, iar un scor <strong>peste 100</strong> indică utilizarea strategiilor de camuflare a trăsăturilor autiste.</p>
                            </div>
                        </div>
                    </div>

                    <p class="mt-3">Testul CAT-Q îți oferă un <strong>scor total de camuflare</strong>, precum și scoruri pe trei subcategorii:</p>

                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div>
                            <strong>Compensare (9 afirmații)</strong>
                            <div class="small">Strategii folosite pentru a compensa dificultățile sociale, cum ar fi copierea limbajului corporal sau învățarea indicilor sociali din filme</div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle bg-danger text-white d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-mask"></i>
                        </div>
                        <div>
                            <strong>Mascare (8 afirmații)</strong>
                            <div class="small">Strategii pentru a ascunde trăsăturile autiste, cum ar fi ajustarea expresiei faciale sau forțarea contactului vizual</div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="rounded-circle bg-success text-white d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <strong>Asimilare (8 afirmații)</strong>
                            <div class="small">Strategii pentru a te integra social, cum ar fi evitarea sau forțarea interacțiunilor pentru a părea "normal"</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 border-top pt-4">
                <div class="alert alert-secondary">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-info-circle fa-2x text-primary"></i>
                        </div>
                        <div>
                            <h5 class="alert-heading">Fiabilitatea testului</h5>
                            <p class="mb-0">Testul CAT-Q este un instrument orientativ extrem de fiabil, iar studiile arată că are o consistență internă ridicată și o bună stabilitate în timp. Acest test poate evidenția diferențele dintre cum te comporți în fața altora și cine ești cu adevărat, ajutându-te să înțelegi mai bine camuflarea trăsăturilor autiste în viața de zi cu zi.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Test instructions -->
    <div class="card mb-4 border-0 shadow-sm">
        <div class="card-header bg-light">
            <h3 class="h5 mb-0"><i class="fas fa-info-circle text-primary me-2"></i>Instrucțiuni pentru completarea testului</h3>
        </div>
        <div class="card-body">
            <p class="mb-3">Vă rugăm să citiți fiecare afirmație de mai jos și să alegeți răspunsul care descrie cel mai bine experiențele dvs. în timpul interacțiunilor sociale. Pentru fiecare afirmație, aveți la dispoziție 7 opțiuni de răspuns:</p>

            <div class="d-flex flex-wrap justify-content-between mb-4">
                <div class="badge bg-light text-dark p-2 mb-2">1. Dezacord puternic</div>
                <div class="badge bg-light text-dark p-2 mb-2">2. Dezacord</div>
                <div class="badge bg-light text-dark p-2 mb-2">3. Dezacord parțial</div>
                <div class="badge bg-light text-dark p-2 mb-2">4. Nici de acord, nici în dezacord</div>
                <div class="badge bg-light text-dark p-2 mb-2">5. Acord parțial</div>
                <div class="badge bg-light text-dark p-2 mb-2">6. Acord</div>
                <div class="badge bg-light text-dark p-2 mb-2">7. Acord puternic</div>
            </div>

            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong>Important:</strong> Răspundeți cât mai sincer posibil. Nu există răspunsuri "corecte" sau "greșite". Dacă preferi să îți auto-evaluezi scorul, vei găsi secțiunea „Self-scoring" cu explicații detaliate pentru calcularea punctajului la finalul testului.
            </div>
        </div>
    </div>

    <!-- Citation section -->
    <div class="card mb-5 border-0 shadow-sm">
        <div class="card-header bg-light">
            <h3 class="h5 mb-0"><i class="fas fa-book text-primary me-2"></i>Citare academică</h3>
        </div>
        <div class="card-body">
            <p class="mb-1"><strong>Studiul original:</strong></p>
            <p class="font-italic">Hull, L., Mandy, W., Lai, M. C., Baron-Cohen, S., Allison, C., Smith, P., & Petrides, K. V. (2019). Development and validation of the Camouflaging Autistic Traits Questionnaire (CAT-Q). Journal of Autism and Developmental Disorders, 49(3), 819-833.</p>
            <a href="https://doi.org/10.1007/s10803-018-3792-6" target="_blank" class="btn btn-outline-primary mt-2">
                <i class="fas fa-external-link-alt me-1"></i> Vezi studiul complet
            </a>
        </div>
    </div>
</div>
<div class="container">
    <!-- Progress bar container -->
    <div class="progress-container">
        <div class="progress-stats">
            <span class="questions-completed"><b>0</b> din <b>25</b> întrebări</span>
            <span class="time-estimate">Timp rămas estimat: <b>10 minute</b></span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        <div class="progress-message">
            🚀 Hai să începem! Primul pas este cel mai important! 💫
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-12 col-lg-10">
            <h1 class="text-center mt-4 mb-3">Chestionarul CAT-Q</h1>
            <p class="lead text-center mb-4">Chestionarul de evaluare a tendințelor de camuflare a trăsăturilor autiste</p>

            <!-- Initial disclaimers -->
            <div class="alert alert-warning alert-dismissible fade show mb-4" role="alert" id="first-disclaimer">
                <h4 class="alert-heading">Important</h4>
                <p>Acest test este destinat <b>EXCLUSIV</b> în scop informativ și <b>NU</b> trebuie utilizat ca instrument de diagnostic.</p>
                <p>Pentru evaluări profesionale, vă recomandăm să vizitați <a href="https://www.doctoradhd.com/" target="_blank">doctoradhd.com</a>.</p>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>

            <form id="catqForm" class="mb-4">
                <div id="questions" class="mb-4">
                    <!-- Questions will be populated here -->
                </div>
                <div id="error" class="alert alert-danger" style="display: none;"></div>
                <div id="errorBelow" class="alert alert-danger" style="display: none;"></div>

                <button type="button" id="submitBtn" class="btn btn-primary btn-lg w-100 mb-4 action-btn calculate-btn">
                    <i class="fas fa-calculator"></i>
                    Calculează Scorul
                </button>
            </form>

            <div id="result" class="result" style="display: none;">
                <!-- Results will be populated here by JavaScript -->
            </div>
        </div>
    </div>
</div>

<!-- Update the restart warning modal HTML -->
<div class="modal fade" id="restartWarningModal" tabindex="-1" aria-labelledby="restartWarningModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="restartWarningModalLabel">
                    <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                    Confirmare restart test
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning mb-3">
                    <strong>Atenție!</strong> Sunteți pe cale să începeți un test nou.
                </div>
                <p>
                    Toate răspunsurile și scorul actual vor fi șterse. Vă recomandăm să exportați mai întâi
                    rezultatele ca PDF dacă doriți să le păstrați.
                </p>
                <p class="mb-0">
                    Doriți să continuați?
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>
                    Anulează
                </button>
                <button type="button" class="btn btn-danger" id="confirmRestartBtn">
                    <i class="fas fa-redo me-2"></i>
                    Da, începe un test nou
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- html2pdf library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
// Question definitions with categories
const questions = [
    { id: 1, text: 'Atunci când interacționez cu cineva, îmi copiez în mod deliberat limbajul corporal sau expresiile faciale.', category: "Compensare" },
    { id: 2, text: 'Îmi monitorizez limbajul corporal sau expresiile faciale pentru a părea relaxat(ă).', category: "Mascare" },
    { id: 3, text: 'Rar simt nevoia de a mă preface pentru a trece printr-o situație socială.', category: "Asimilare", reverse: true },
    { id: 4, text: 'Am dezvoltat un scenariu pe care îl urmez în situațiile sociale.', category: "Compensare" },
    { id: 5, text: 'Repet fraze pe care le-am auzit de la alții exact în același mod în care le-am auzit prima dată.', category: "Compensare" },
    { id: 6, text: 'Îmi ajustez limbajul corporal sau expresiile faciale pentru a părea interesat(ă) de persoana cu care interacționez.', category: "Mascare" },
    { id: 7, text: 'În situațiile sociale, simt că „interpretez" un rol mai degrabă decât că sunt eu însumi/însămi.', category: "Asimilare" },
    { id: 8, text: 'În propriile mele interacțiuni sociale, folosesc comportamente pe care le-am învățat observându-i pe alții.', category: "Compensare" },
    { id: 9, text: 'Mă gândesc întotdeauna la impresia pe care o las asupra altor persoane.', category: "Mascare" },
    { id: 10, text: 'Am nevoie de sprijinul altor persoane pentru a socializa.', category: "Asimilare" },
    { id: 11, text: 'Exersez expresiile faciale și limbajul corporal pentru a mă asigura că arată natural.', category: "Compensare" },
    { id: 12, text: 'Nu simt nevoia de a face contact vizual cu alte persoane dacă nu vreau.', category: "Mascare", reverse: true },
    { id: 13, text: 'Trebuie să mă forțez să interacționez cu oamenii atunci când sunt în situații sociale.', category: "Asimilare" },
    { id: 14, text: 'Am încercat să îmi îmbunătățesc înțelegerea abilităților sociale observându-i pe alții.', category: "Compensare" },
    { id: 15, text: 'Îmi monitorizez limbajul corporal sau expresiile faciale pentru a părea interesat(ă) de persoana cu care interacționez.', category: "Mascare" },
    { id: 16, text: 'În situațiile sociale, încerc să găsesc modalități de a evita interacțiunea cu ceilalți.', category: "Asimilare" },
    { id: 17, text: 'Am cercetat regulile interacțiunilor sociale pentru a-mi îmbunătăți propriile abilități sociale.', category: "Compensare" },
    { id: 18, text: 'Sunt întotdeauna conștient(ă) de impresia pe care o las asupra altor persoane.', category: "Mascare" },
    { id: 19, text: 'Mă simt liber(ă) să fiu eu însumi/însămi atunci când sunt cu alte persoane.', category: "Asimilare", reverse: true },
    { id: 20, text: 'Învăț cum folosesc oamenii corpul și fața pentru a interacționa urmărind emisiuni TV sau filme, sau citind ficțiune.', category: "Compensare" },
    { id: 21, text: 'Îmi ajustez limbajul corporal sau expresiile faciale pentru a părea relaxat(ă).', category: "Mascare" },
    { id: 22, text: 'Atunci când vorbesc cu alte persoane, simt că conversația curge în mod natural.', category: "Asimilare", reverse: true },
    { id: 23, text: 'Am petrecut timp învățând abilități sociale din emisiuni TV și filme și încerc să le folosesc în interacțiunile mele.', category: "Compensare" },
    { id: 24, text: 'În interacțiunile sociale, nu acord atenție la ceea ce face fața sau corpul meu.', category: "Mascare", reverse: true },
    { id: 25, text: 'În situațiile sociale, simt că mă prefac că sunt „normal(ă)".', category: "Asimilare" }
];

const form = document.getElementById('catqForm');
const questionsContainer = document.getElementById('questions');

// Initialize form with questions
questions.forEach((question, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.classList.add('question', 'mb-4');
    questionDiv.setAttribute('role', 'group');
    questionDiv.setAttribute('aria-labelledby', `question-${index}-label`);
    questionDiv.setAttribute('data-question-number', index + 1);

    // Question label container
    const questionLabel = document.createElement('div');
    questionLabel.id = `question-${index}-label`;
    questionLabel.classList.add('question-text');
    questionLabel.innerHTML = `${index + 1}. ${question.text}`;

    // Add category indicator for screen readers
    const categoryNote = document.createElement('span');
    categoryNote.classList.add('sr-only');
    categoryNote.innerHTML = ` (${question.category})`;
    questionLabel.appendChild(categoryNote);

    questionDiv.appendChild(questionLabel);

    // Create fieldset for radio buttons
    const fieldset = document.createElement('fieldset');
    fieldset.classList.add('options');

    // Add legend for screen readers
    const legend = document.createElement('legend');
    legend.classList.add('sr-only');
    legend.innerHTML = `Opțiuni pentru întrebarea ${index + 1}`;
    fieldset.appendChild(legend);

    const options = [
        {
            label: "Dezacord puternic",
            value: question.reverse ? "7" : "1",
            description: "Dezacord total sau puternic cu afirmația"
        },
        {
            label: "Dezacord",
            value: question.reverse ? "6" : "2",
            description: "Dezacord sau respingere a afirmației"
        },
        {
            label: "Ușor dezacord",
            value: question.reverse ? "5" : "3",
            description: "Ușoară dezaprobare sau respingere a afirmației"
        },
        {
            label: "Neutru",
            value: "4",
            description: "Nici acord, nici dezacord cu afirmația"
        },
        {
            label: "Ușor acord",
            value: question.reverse ? "3" : "5",
            description: "Ușoară aprobare sau acceptare a afirmației"
        },
        {
            label: "Acord",
            value: question.reverse ? "2" : "6",
            description: "Acord sau acceptare a afirmației"
        },
        {
            label: "Acord puternic",
            value: question.reverse ? "1" : "7",
            description: "Acord total sau puternic cu afirmația"
        }
    ];

    options.forEach((option, optionIndex) => {
        const label = document.createElement('label');
        label.classList.add('form-check');
        label.setAttribute('for', `q${index}o${optionIndex}`);

        const input = document.createElement('input');
        input.type = 'radio';
        input.id = `q${index}o${optionIndex}`;
        input.name = `q${index}`;
        input.value = option.value;
        input.classList.add('form-check-input');
        input.setAttribute('aria-describedby', `q${index}o${optionIndex}-desc`);

        const span = document.createElement('span');
        span.classList.add('form-check-label');
        span.innerHTML = option.label;

        // Add description for screen readers
        const description = document.createElement('span');
        description.id = `q${index}o${optionIndex}-desc`;
        description.classList.add('sr-only');
        description.innerHTML = option.description;

        label.appendChild(input);
        label.appendChild(span);
        label.appendChild(description);
        fieldset.appendChild(label);
    });

    questionDiv.appendChild(fieldset);

    // Add help button
    const helpButton = document.createElement('button');
    helpButton.type = 'button';
    helpButton.classList.add('help-button', 'btn', 'btn-link', 'mt-2');
    helpButton.innerHTML = '<i class="fas fa-question-circle"></i> Ajutor pentru această întrebare';
    helpButton.setAttribute('aria-expanded', 'false');
    helpButton.setAttribute('aria-controls', `help-${index}`);

    const helpContent = document.createElement('div');
    helpContent.id = `help-${index}`;
    helpContent.classList.add('help-content');
    helpContent.setAttribute('hidden', '');
    helpContent.innerHTML = `
        <div class="alert alert-info mt-2">
            <p>Această întrebare face parte din categoria: <strong>${question.category}</strong></p>
            <p>${getHelpText(question.category)}</p>
            <p>Selectați opțiunea care descrie cel mai bine experiența dumneavoastră.</p>
        </div>
    `;

    questionDiv.appendChild(helpButton);
    questionDiv.appendChild(helpContent);

    questionsContainer.appendChild(questionDiv);
});

// Helper Functions
function getHelpText(category) {
    const helpTexts = {
        "Compensare": "Strategii folosite pentru a compensa activ dificultățile în situații sociale.",
        "Mascare": "Strategii folosite pentru a ascunde caracteristicile autiste.",
        "Asimilare": "Strategii folosite pentru a încerca să se potrivească cu ceilalți în situații sociale."
    };
    return helpTexts[category] || "";
}

function getInterpretation(score) {
    if (score < 50) {
        return 'Nivel scăzut de camuflare a trăsăturilor autiste.';
    } else if (score < 100) {
        return 'Nivel moderat de camuflare a trăsăturilor autiste.';
    } else if (score < 150) {
        return 'Nivel ridicat de camuflare a trăsăturilor autiste.';
    } else {
        return 'Nivel foarte ridicat de camuflare a trăsăturilor autiste.';
    }
}

function getProgressMessage(percentage, answered) {
    if (percentage === 0) return '🚀 Hai să începem! Primul pas este cel mai important! 💫';
    if (percentage <= 25) return '🌟 Minunat început! Continuă tot așa! 💪';
    if (percentage <= 50) return '🎯 La jumătatea drumului! Ești pe drumul cel bun! ⭐';
    if (percentage <= 75) return '💫 Excelent progres! Mai puțin de un sfert rămas! 🎈';
    if (percentage < 100) return '🎊 Aproape gata! Încă puțin! 🌟';
    return '🎉 FELICITĂRI! Ai completat tot testul! 🎯 Clic pe butonul CALCULEAZĂ SCOR pentru a vedea rezultatele!';
}

// Progress Tracking
const progressContainer = document.querySelector('.progress-container');
const progressFill = document.querySelector('.progress-fill');
const questionsCompleted = document.querySelector('.questions-completed');
const timeEstimate = document.querySelector('.time-estimate');
const progressMessage = document.querySelector('.progress-message');

// Monitor radio changes for progress updates
document.addEventListener('change', (e) => {
    if (e.target.type === 'radio') {
        const currentQuestion = e.target.closest('.question');
        if (currentQuestion) {
            currentQuestion.classList.add('completed');
            updateProgress();

            currentQuestion.classList.remove('highlight-unanswered');

            // Also clear any error messages when a question is answered
            const errorDiv = document.getElementById('error');
            const errorBelowDiv = document.getElementById('errorBelow');

            if (errorDiv) {
                errorDiv.style.display = 'none';
                errorDiv.innerHTML = '';
            }
            if (errorBelowDiv) {
                errorBelowDiv.style.display = 'none';
                errorBelowDiv.innerHTML = '';
            }

            // Find next unanswered question
            const nextUnanswered = Array.from(document.querySelectorAll('.question:not(.completed)'))
                .find(q => !q.querySelector('input[type="radio"]:checked'));

            if (nextUnanswered) {
                document.querySelectorAll('.question').forEach(q => q.classList.remove('current'));
                nextUnanswered.classList.add('current');
                scrollToQuestion(nextUnanswered);
            }
        }
    }
});

// Monitor scroll for progress bar visibility
window.addEventListener('scroll', () => {
    const testContainer = document.getElementById('questions');
    if (testContainer) {
        const rect = testContainer.getBoundingClientRect();
        const hasAnswers = document.querySelector('input[type="radio"]:checked') !== null;

        if (rect.top <= 0 && rect.bottom >= 0 && hasAnswers) {
            progressContainer.classList.add('visible');
        } else {
            progressContainer.classList.remove('visible');
        }
    }
});

// Initial progress update
updateProgress();

function updateProgress() {
    const progressFill = document.querySelector('.progress-fill');
    const questionsCompleted = document.querySelector('.questions-completed');
    const timeEstimate = document.querySelector('.time-estimate');
    const progressMessage = document.querySelector('.progress-message');

    if (!progressFill || !questionsCompleted || !timeEstimate || !progressMessage) {
        return;
    }

    const answered = document.querySelectorAll('input[type="radio"]:checked').length;
    const total = questions.length;
    const percentage = (answered / total) * 100;

    progressFill.style.width = `${percentage}%`;
    questionsCompleted.innerHTML = `<b>${answered}</b> din <b>${total}</b> întrebări`;

    const remainingQuestions = total - answered;
    const estimatedMinutes = Math.max(Math.ceil(remainingQuestions * 0.4), 1);
    timeEstimate.innerHTML = `Timp rămas estimat: <b>${estimatedMinutes} minute</b>`;

    progressMessage.innerHTML = getProgressMessage(percentage, answered);
}

// Score Calculation
function calculateScores() {
    let totalScore = 0;
    let compensationScore = 0;
    let maskingScore = 0;
    let assimilationScore = 0;

    questions.forEach((question, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected) {
            const score = parseInt(selected.value);
            totalScore += score;

            switch(question.category) {
                case "Compensare": compensationScore += score; break;
                case "Mascare": maskingScore += score; break;
                case "Asimilare": assimilationScore += score; break;
            }
        }
    });

    return {
        totalScore,
        compensationScore,
        maskingScore,
        assimilationScore
    };
}

// Results Display
function displayResults({ totalScore, compensationScore, maskingScore, assimilationScore }) {
    const resultDiv = document.getElementById('result');
    const submitBtn = document.getElementById('submitBtn');

    if (!resultDiv || !submitBtn) return;

    const interpretation = getInterpretation(totalScore);

    resultDiv.innerHTML = `
        <div class="result-card">
            <div class="card-header bg-white py-3">
                <h2 class="card-title text-center mb-0 fw-bold">Rezultatele testului CAT-Q</h2>
            </div>

            <div class="card-body p-4">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="total-score-section text-center p-4 mb-4"
                             style="background-color: #f8f9fa; border-radius: 8px;">
                            <h3 class="h4 mb-3">Scor Total</h3>
                            <div class="display-4 mb-2 total-score"
                                 data-value="${totalScore}">
                                ${totalScore}
                            </div>
                            <p class="mb-0 text-muted interpretation-text">
                                ${interpretation}
                            </p>
                        </div>
                    </div>
                </div>

                <h4 class="mb-4 fw-bold">Scoruri pe categorii</h4>

                ${createScoreSection(
                    "Compensare",
                    compensationScore,
                    63,
                    31,
                    "Strategii folosite pentru a compensa activ dificultățile în situații sociale.",
                    "compensation"
                )}

                ${createScoreSection(
                    "Mascare",
                    maskingScore,
                    56,
                    28,
                    "Strategii folosite pentru a ascunde caracteristicile autiste.",
                    "masking"
                )}

                ${createScoreSection(
                    "Asimilare",
                    assimilationScore,
                    56,
                    28,
                    "Strategii folosite pentru a încerca să se potrivească cu ceilalți în situații sociale.",
                    "assimilation"
                )}

                <div class="action-buttons mt-4">
                    <button onclick="shareToFacebook()" class="btn btn-primary action-btn mb-3">
                        <i class="fab fa-facebook-f"></i> Distribuie pe Facebook
                    </button>
                    <button onclick="exportToPDF()" class="btn btn-success action-btn mb-3">
                        <i class="fas fa-file-pdf"></i> Exportă ca PDF
                    </button>
                    <button onclick="showRestartWarning()" class="btn btn-danger action-btn">
                        <i class="fas fa-redo"></i> Începe un nou test
                    </button>
                </div>
            </div>
        </div>
    `;

    resultDiv.style.display = 'block';
    submitBtn.style.display = 'none';

    // Store scores in data attributes
    resultDiv.dataset.totalScore = totalScore;
    resultDiv.dataset.compensationScore = compensationScore;
    resultDiv.dataset.maskingScore = maskingScore;
    resultDiv.dataset.assimilationScore = assimilationScore;

    // Scroll to results
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });

    // Hide progress bar
    const progressContainer = document.querySelector('.progress-container');
    if (progressContainer) {
        progressContainer.classList.remove('visible');
    }
}

// Create Score Section Helper
function createScoreSection(title, score, maxScore, threshold, description, category) {
    const percentage = (score / maxScore) * 100;
    const color = score >= threshold ? 'danger' : 'success';

    return `
        <div class="score-section" data-category="${category}">
            <div class="score-label">${title}</div>
            <div class="score-value" data-score="${score}" data-max="${maxScore}" data-threshold="${threshold}">
                ${score} / ${maxScore}
            </div>
            <div class="score-bar">
                <div class="score-fill bg-${color}" style="width: ${percentage}%"></div>
                <div class="threshold-marker" style="left: ${(threshold/maxScore)*100}%"></div>
            </div>
            <div class="score-description mt-2">${description}</div>
        </div>
    `;
}

// PDF Export Functionality
async function exportToPDF() {
    // Calculate scores directly
    const results = calculateScores();
    const { totalScore, compensationScore, maskingScore, assimilationScore } = results;

    // Create container with A4 dimensions
    const container = document.createElement('div');
    container.style.cssText = `
        width: 595px; /* A4 width in points */
        background: white;
        position: fixed;
        left: 0;
        top: 0;
        padding: 40px;
        z-index: -9999;
        font-family: Arial, sans-serif;
        font-size: 11px;
        color: black;
        box-sizing: border-box;
    `;
    document.body.appendChild(container);

    const getScoreColor = (score, threshold) => {
        if (score < threshold) return '#4CAF50';
        if (score < threshold * 1.5) return '#FFC107';
        return '#F44336';
    };

    const contentHtml = `
        <div style="background: white; color: black; max-width: 515px;">
            <h1 style="font-size: 16px; text-align: center; margin-bottom: 12px; color: black;">
                Rezultate Test CAT-Q
            </h1>

            <div style="text-align: center; background-color: #f8f9fa; padding: 8px; margin: 12px 0; border-radius: 4px;">
                <span style="color: #666; font-size: 10px;">Rezultate generate de</span><br>
                <a href="https://www.testautism.ro" style="color: #2196F3; font-size: 12px; font-weight: bold;">
                    www.testautism.ro
                </a>
            </div>

            <div style="background-color: #fff3cd; border: 1px solid #ffeeba; padding: 10px; margin: 12px 0; border-radius: 4px;">
                <p style="color: #856404; margin: 0; font-size: 10px; line-height: 1.4;">
                    <strong>IMPORTANT:</strong> Acest test este destinat <strong>EXCLUSIV</strong> în scop informativ și
                    <strong>NU</strong> trebuie utilizat ca instrument de diagnostic. Pentru evaluări profesionale,
                    vă recomandăm să vizitați <a href="https://www.doctoradhd.com" style="color: #856404; font-weight: bold;">www.doctoradhd.com</a>
                </p>
            </div>

            <div style="text-align: center; background-color: #f8f9fa; padding: 12px; margin: 12px 0; border-radius: 4px;">
                <h2 style="font-size: 14px; margin-bottom: 8px; color: black;">Scor Total: ${totalScore}</h2>
                <p style="color: #666; font-size: 11px; line-height: 1.4;">${getInterpretation(totalScore)}</p>
            </div>

            <h3 style="font-size: 13px; margin: 12px 0; color: black;">Scoruri pe categorii:</h3>

            <div style="margin-bottom: 20px;">
                ${[
                    {
                        name: 'Compensare',
                        score: compensationScore,
                        max: 63,
                        threshold: 31
                    },
                    {
                        name: 'Mascare',
                        score: maskingScore,
                        max: 56,
                        threshold: 28
                    },
                    {
                        name: 'Asimilare',
                        score: assimilationScore,
                        max: 56,
                        threshold: 28
                    }
                ].map(category => {
                    const percentage = (category.score / category.max) * 100;
                    const color = getScoreColor(category.score, category.threshold);
                    return `
                        <div style="margin-bottom: 16px; background: white;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong style="color: black; font-size: 11px;">${category.name}</strong>
                                <span style="color: black; font-size: 11px;">${category.score} / ${category.max}</span>
                            </div>
                            <div style="position: relative; height: 16px; background-color: #e9ecef; border-radius: 3px; overflow: hidden;">
                                <div style="position: absolute; left: 0; top: 0; height: 100%; width: ${percentage}%; background-color: ${color};"></div>
                                <div style="position: absolute; left: ${(category.threshold/category.max)*100}%; top: 0; height: 100%; width: 2px; background-color: black;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 2px; font-size: 9px; color: #666;">
                                <span>0</span>
                                <span>Prag: ${category.threshold}</span>
                                <span>${category.max}</span>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>

            <div style="margin: 16px 0; padding: 10px; background-color: #f8f9fa; border-radius: 4px;">
                <strong style="color: black; font-size: 11px;">Legendă:</strong><br>
                <span style="color: #4CAF50;">■</span> Sub prag &nbsp;&nbsp;
                <span style="color: #FFC107;">■</span> Aproape de prag &nbsp;&nbsp;
                <span style="color: #F44336;">■</span> Peste prag
            </div>

            <div style="margin-top: 16px; text-align: right; color: #666; font-size: 9px;">
                Data testului: ${new Date().toLocaleDateString('ro-RO')}
            </div>
        </div>
    `;

    // Set container content
    container.innerHTML = contentHtml;

    // Add questions and answers
    let questionIndex = 0;
    questions.forEach((question, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected) {
            const questionDiv = document.createElement('div');
            questionDiv.style.cssText = `margin-bottom: 30px; color: black;`;

            if ((questionIndex + 1) % 9 === 0) {
                questionDiv.style.pageBreakAfter = 'always';
            }

            questionDiv.innerHTML = `
                <p style="margin-bottom: 5px; font-weight: bold; color: black;">
                    ${index + 1}. ${question.text}
                </p>
                <p style="margin-left: 15px; margin-bottom: 20px; color: black;">
                    Răspuns: ${selected.closest('.form-check').querySelector('.form-check-label').textContent.trim()}
                </p>
            `;

            container.appendChild(questionDiv);
            questionIndex++;
        }
    });

    // PDF generation options
    const opt = {
        margin: [25, 20, 25, 20], // [top, right, bottom, left]
        filename: 'rezultate_test_cat_q.pdf',
        image: { type: 'jpeg', quality: 1 },
        html2canvas: {
            scale: 2,
            useCORS: true,
            allowTaint: true,
            backgroundColor: '#FFFFFF',
            width: 595,
            height: container.offsetHeight
        },
        jsPDF: {
            unit: 'pt',
            format: 'a4',
            orientation: 'portrait',
            putOnlyUsedFonts: true,
            compress: true
        },
        pagebreak: {
            mode: ['avoid-all', 'css', 'legacy']
        }
    };

    try {
        // Wait for content to render
        await new Promise(resolve => setTimeout(resolve, 300));

        // Generate PDF
        await html2pdf().set(opt).from(container).save();

        console.log('PDF generated successfully');
    } catch (error) {
        console.error('Error generating PDF:', error);
        alert('A apărut o eroare la generarea PDF-ului. Vă rugăm să încercați din nou.');
    } finally {
        // Clean up
        document.body.removeChild(container);
    }
}

// Facebook Share Functionality
function shareToFacebook() {
    const scores = calculateScores();
    const shareText = `Am obținut un scor de ${scores.totalScore} la testul CAT-Q de evaluare a tendințelor de camuflare a trăsăturilor autiste. Află mai multe despre camuflarea autistă pe testautism.ro`;

    const shareUrl = 'https://www.facebook.com/sharer/sharer.php?u=' +
                    encodeURIComponent(window.location.href) +
                    '&quote=' + encodeURIComponent(shareText);

    window.open(shareUrl, '_blank', 'width=600,height=400');
}

// Restart Functionality
function showRestartWarning() {
    const modal = new bootstrap.Modal(document.getElementById('restartWarningModal'));
    modal.show();
}

function restartTest() {
    // Reset progress container
    const progressContainer = document.querySelector('.progress-container');
    if (progressContainer) {
        progressContainer.style.display = '';
        setTimeout(() => progressContainer.classList.add('visible'), 10);
    }

    // Reset form elements
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.checked = false;
        radio.disabled = false;
    });

    // Reset question states
    document.querySelectorAll('.question').forEach(question => {
        question.classList.remove('completed', 'current', 'highlight-unanswered');
    });

    // Add current class to first question
    const firstQuestion = document.querySelector('.question');
    if (firstQuestion) {
        firstQuestion.classList.add('current');
    }

    // Reset UI elements
    const resultDiv = document.getElementById('result');
    const submitBtn = document.getElementById('submitBtn');
    const errorDiv = document.getElementById('error');
    const errorBelowDiv = document.getElementById('errorBelow');

    if (resultDiv) resultDiv.style.display = 'none';
    if (submitBtn) submitBtn.style.display = 'block';
    if (errorDiv) errorDiv.style.display = 'none';
    if (errorBelowDiv) errorBelowDiv.style.display = 'none';

    // Hide modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('restartWarningModal'));
    if (modal) modal.hide();

    // Reset progress
    updateProgress();

    // Scroll to first question
    if (firstQuestion) {
        scrollToQuestion(firstQuestion);
    }
}

// Helper function for scrolling
function scrollToQuestion(questionElement) {
    const progressContainer = document.querySelector('.progress-container');
    const offset = progressContainer ? progressContainer.offsetHeight + 20 : 20;

    window.scrollTo({
        top: questionElement.offsetTop - offset,
        behavior: 'smooth'
    });
}

// Add event listener for restart confirmation
document.getElementById('confirmRestartBtn').addEventListener('click', restartTest);

// Submit button event handler
document.getElementById('submitBtn').addEventListener('click', (e) => {
    e.preventDefault();

    // Reset error states
    const errorDiv = document.getElementById('error');
    const errorBelowDiv = document.getElementById('errorBelow');

    if (errorDiv) {
        errorDiv.style.display = 'none';
        errorDiv.innerHTML = '';
    }
    if (errorBelowDiv) {
        errorBelowDiv.style.display = 'none';
        errorBelowDiv.innerHTML = '';
    }

    // Clear previous highlights
    document.querySelectorAll('.highlight-unanswered').forEach(el => {
        el.classList.remove('highlight-unanswered');
    });

    // Check for unanswered questions
    let unanswered = [];
    questions.forEach((_, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (!selected) {
            unanswered.push(index + 1);
            const questionDiv = document.querySelector(`[data-question-number="${index + 1}"]`);
            if (questionDiv) {
                questionDiv.classList.add('highlight-unanswered');
            }
        }
    });

    // Handle unanswered questions with more detailed error message
    if (unanswered.length > 0) {
        const errorMessage = `
            <div class="alert-heading mb-2">
                <i class="fas fa-exclamation-circle"></i>
                Te rog să răspunzi la toate întrebările
            </div>
            <p class="mb-2">Întrebări fără răspuns: ${unanswered.join(', ')}</p>
            <small class="text-muted">
                Click pe numere pentru a naviga la întrebările respective
            </small>
        `;

        if (errorDiv) {
            errorDiv.innerHTML = errorMessage;
            errorDiv.style.display = 'block';
        }
        if (errorBelowDiv) {
            errorBelowDiv.innerHTML = errorMessage;
            errorBelowDiv.style.display = 'block';
        }

        // Add click handlers to question numbers in error message
        const numberLinks = document.querySelectorAll('.alert-danger');
        numberLinks.forEach(alert => {
            alert.addEventListener('click', (e) => {
                const number = e.target.textContent;
                if (!isNaN(number)) {
                    const questionDiv = document.querySelector(`[data-question-number="${number}"]`);
                    if (questionDiv) {
                        scrollToQuestion(questionDiv);
                    }
                }
            });
        });

        // Find and scroll to first unanswered with proper offset
        const firstUnanswered = document.querySelector('.highlight-unanswered');
        if (firstUnanswered) {
            const progressContainer = document.querySelector('.progress-container');
            const offset = progressContainer ? progressContainer.offsetHeight + 20 : 20;

            window.scrollTo({
                top: firstUnanswered.getBoundingClientRect().top + window.pageYOffset - offset,
                behavior: 'smooth'
            });
        }
        return;
    }

    // If all questions are answered, proceed with scoring
    const scores = calculateScores();
    displayResults(scores);

    // Hide progress bar and error messages after completion
    const progressContainer = document.querySelector('.progress-container');
    if (progressContainer) {
        progressContainer.classList.remove('visible');
    }

    // Disable all radio inputs
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.disabled = true;
    });
});
</script>
</body>
</html>