<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- FontAwesome CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<!-- HTML2PDF (for PDF export) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<!-- HTML2CANVAS (for Facebook sharing) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<meta name="description" content="Test autoevaluare și autodiagnosticare autism (Tulburare de Spectru Autist - TSA) adulți. RAADS-R oferă evaluare precisă a trăsăturilor autiste" />
<link rel="icon" href="https://www.suntautist.ro/content/images/size/w256h256/2022/01/suntautist-logo-mini.png" type="image/png">

<link rel="canonical" href="https://www.testautism.ro">
<meta name="referrer" content="no-referrer-when-downgrade" />

<!-- Facebook OpenGraph tags -->
<meta property="og:site_name" content="Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)" />
<meta property="og:description" content="Test autoevaluare și autodiagnosticare autism (Tulburare de Spectru Autist - TSA) adulți. RAADS-R oferă evaluare precisă a trăsăturilor autiste" />
<meta property="og:url" content="https://www.testautism.ro" />
<meta property="og:image" content="https://www.suntautist.ro/content/images/2024/11/raads-r-tris.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="675" />

<!-- Article metadata -->
<meta property="article:published_time" content="2024-11-04T00:00:00.000Z" />
<meta property="article:modified_time" content="2024-11-04T00:00:00.000Z" />
<meta property="article:publisher" content="https://www.facebook.com/suntautist/" />

<!-- Twitter cards metadata -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)" />
<meta name="twitter:description" content="Test autoevaluare și autodiagnosticare autism (Tulburare de Spectru Autist - TSA) adulți. RAADS-R oferă evaluare precisă a trăsăturilor autiste" />
<meta name="twitter:url" content="https://www.testautism.ro" />
<meta name="twitter:image" content="https://www.suntautist.ro/content/images/2024/11/raads-r-tris.jpg" />

<!-- LD JSON Schema -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)",
        "url": "https://www.testautism.ro/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.suntautist.ro/content/images/size/w256h256/2022/01/suntautist-logo-mini.png"
        }
    },
    "headline": "Test Autism Adulți. Scala Ritvo Autism Asperger Diagnostic (RAADS-R)",
    "url": "https://www.testautism.ro/",
    "datePublished": "2024-10-06T14:37:01.000Z",
    "dateModified": "2024-10-06T15:12:44.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.suntautist.ro/content/images/2024/11/raads-r-tris.jpg",
        "width": 1200,
        "height": 675
    },
    "description": "Test RAADS-R (Revizuit). Scala Ritvo Autism Asperger Diagnostic Revizuită. Acest test constă în 80 de afirmații pentru a ajuta la screeningul autismului la adulți. Această evaluare este destinată exclusiv pentru scopuri informative și NU trebuie utilizată ca un instrument de diagnostic.",
    "mainEntityOfPage": "https://www.testautism.ro/"
}
</script>
<script>
(function(d){
  var s = d.createElement("script");
  /* uncomment the following line to override default position*/
  /* s.setAttribute("data-position", 3);*/
  /* uncomment the following line to override default size (values: small, large)*/
  /* s.setAttribute("data-size", "small");*/
  /* uncomment the following line to override default language (e.g., fr, de, es, he, nl, etc.)*/
  /* s.setAttribute("data-language", "language");*/
  /* uncomment the following line to override color set via widget (e.g., #053f67)*/
  /* s.setAttribute("data-color", "#053e67");*/
  /* uncomment the following line to override type set via widget (1=person, 2=chair, 3=eye, 4=text)*/
  /* s.setAttribute("data-type", "1");*/
  /* s.setAttribute("data-statement_text:", "Our Accessibility Statement");*/
  /* s.setAttribute("data-statement_url", "http://www.example.com/accessibility")";*/
  /* uncomment the following line to override support on mobile devices*/
  /* s.setAttribute("data-mobile", true);*/
  /* uncomment the following line to set custom trigger action for accessibility menu*/
  /* s.setAttribute("data-trigger", "triggerId")*/
  s.setAttribute("data-account", "vyCmg2Axix");
  s.setAttribute("src", "https://cdn.userway.org/widget.js");
  (d.body || d.head).appendChild(s);
})(document)
</script>
<noscript>Vă rugăm să vă asigurați că Javascript este activat pentru scopuri de <a href="https://userway.org">accesibilitate a site-ului web.</a></noscript>

<style type="text/css">
html {
    scroll-behavior: smooth;
}

body {
    font-family: Arial, sans-serif;
    margin: 20px;
    /*background-color: #f8f9fa;*/
}
.partner-logos {
    padding: 20px 0;
}

.partner-logos img {
    transition: transform 0.2s ease;
}

.partner-logos img:hover {
    transform: scale(1.05);
}

.highlight-unanswered {
    background-color: beige !important;
}

@media (max-width: 768px) {
    .partner-logos .col-12 {
        margin-bottom: 20px;
    }

    .partner-logos img {
        max-width: 100% !important;
        height: auto;
    }
}
@media (max-width: 600px) {
    body {
        margin: 10px;
    }
}
#start-test:hover {
    cursor:pointer !important;
}

.features-container {
    padding: 2rem 0;
    background: #ffffff;
}

.feature-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

.feature-icon {
    margin-bottom: 1.5rem;
    padding: 1.5rem;
    background: #f8f9fa;
    border-radius: 50%;
    width: 90px;
    height: 90px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.feature-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #333;
    margin-bottom: 1.2rem;
}

.feature-text {
    color: #666;
    line-height: 1.6;
    margin-bottom: 0;
}

.feature-note {
    display: block;
    margin-top: 1rem;
    font-size: 0.9rem;
    color: #777;
}

.privacy-features {
    text-align: left;
}

.privacy-item {
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    font-weight: 500;
}

.privacy-item:last-child {
    margin-bottom: 0;
}

.privacy-item i {
    width: 24px;
}

@media (max-width: 768px) {
    .feature-card {
        margin-bottom: 1rem;
    }
}

/* CTA BUTTON */
.cta-button-wrapper {
    text-align: center;
    margin: 1.5rem 0 0.5rem 0;
    padding: 0.5rem;
}

.cta-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px 32px;
    font-size: 1.25rem;
    font-weight: 600;
    color: white;
    background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
}

.cta-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
    transition: transform 0.3s ease;
    transform: translateX(-100%);
}

.cta-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(33, 150, 243, 0.4);
    color: white;
    text-decoration: none;
}

.cta-button:hover::before {
    transform: translateX(0);
}

.cta-button:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(33, 150, 243, 0.3);
}

.cta-button i {
    font-size: 1.4rem;
    transition: transform 0.3s ease;
}

.cta-button:hover i {
    transform: translateX(5px);
}

/* Pulse animation */
@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.4);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(33, 150, 243, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0);
    }
}

.cta-button.pulse {
    animation: pulse 2s infinite;
}

/* Optional emphasis wrapper */
.cta-emphasis {
    position: relative;
    display: inline-block;
}

.cta-emphasis::before,
.cta-emphasis::after {
    content: '✨';
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.5rem;
    opacity: 0.8;
}

.cta-emphasis::before {
    left: -40px;
}

.cta-emphasis::after {
    right: -40px;
}

/* Info panel cards */
.test-details-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
    font-family: Arial, sans-serif;
}

.info-section, .info-card {
    background: white;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
    overflow: hidden;
}

.section-header, .card-header {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #eee;
    background: linear-gradient(45deg, #f8f9fa, #ffffff);
}

.section-header h3, .card-header h3 {
    margin: 0;
    font-size: 1.5rem;
    color: #333;
}

.version-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    padding: 1.5rem;
}

.version-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1.5rem;
}

.version-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #333;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
}

.feature-list {
    list-style: none;
    padding: 0;
    margin: 0 0 1rem 0;
}

.feature-list li {
    display: flex;
    align-items: center;
    margin-bottom: 0.8rem;
    gap: 1rem;
}

.feature-list i {
    width: 20px;
    text-align: center;
}

.citation-box {
    font-size: 0.9rem;
    background: white;
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1rem;
}

.doi-link {
    color: #1877f2;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

.doi-link:hover {
    text-decoration: underline;
}

.target-list {
    list-style: none;
    padding: 1.5rem;
    margin: 0;
}

.target-list li {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.availability-content, .process-content {
    padding: 1.5rem;
}

.highlight-text {
    background: #e8f4ff;
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1rem;
}

.answer-options {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: 8px;
    margin-top: 1rem;
}

.answer-options h4 {
    margin-top: 0;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
}

.answer-options ol {
    margin: 0;
    padding-left: 1.5rem;
}

.answer-options li {
    margin-bottom: 0.5rem;
}

@media (max-width: 768px) {
    .version-cards {
        grid-template-columns: 1fr;
    }
}

/* SCORES section */
.scores-section {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 2rem;
}

.score-card {
    background: white;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
    overflow: hidden;
}

.card-header {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #eee;
    background: linear-gradient(45deg, #f8f9fa, #ffffff);
}

.card-header h3 {
    margin: 0;
    font-size: 1.5rem;
    color: #333;
}

.table-responsive {
    padding: 1.5rem;
    overflow-x: auto;
}

.score-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin: 0;
}

.score-table th,
.score-table td {
    padding: 1rem;
    border-bottom: 1px solid #eee;
    text-align: left;
}

.score-table th {
    background: #f8f9fa;
    font-weight: 600;
    color: #333;
}

.score-table tr:last-child td {
    border-bottom: none;
}

.significance-table td.score-value {
    font-weight: 600;
    color: #1976D2;
    font-size: 1.1rem;
}

.thresholds-table .threshold {
    font-weight: 600;
    color: #2196F3;
}

.thresholds-table .max-score {
    font-weight: 600;
    color: #F44336;
}

/* Hover effects */
.score-table tbody tr {
    transition: background-color 0.2s ease;
}

.score-table tbody tr:hover {
    background-color: #f8f9fa;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .scores-section {
        padding: 0 1rem;
    }

    .table-responsive {
        padding: 1rem;
    }

    .score-table th,
    .score-table td {
        padding: 0.75rem;
    }
}

/* Additional visual enhancements */
.score-table thead th {
    border-bottom: 2px solid #dee2e6;
    position: relative;
}

.score-table thead th:after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, rgba(33,150,243,0.5), rgba(33,150,243,0));
}

/* First column emphasis */
.score-table tbody tr td:first-child {
    font-weight: 500;
}

/* Alternating row colors for better readability */
.score-table tbody tr:nth-child(even) {
    background-color: #fafafa;
}

/* Add subtle transition on hover */
.score-table tbody tr {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.score-table tbody tr:hover {
    transform: translateX(5px);
    box-shadow: -5px 0 10px rgba(0,0,0,0.05);
}

/* SCORING SYSTEM STYLING */
.scoring-system {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 2rem;
}

.scoring-container {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.scoring-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
    overflow: hidden;
}

.card-header {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #eee;
    background: linear-gradient(45deg, #f8f9fa, #ffffff);
}

.card-header h3 {
    margin: 0;
    font-size: 1.5rem;
    color: #333;
}

.scoring-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    padding: 1.5rem;
}

.score-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
    transition: transform 0.2s ease;
}

.score-item:hover {
    transform: translateY(-2px);
}

.score-value {
    font-size: 2rem;
    font-weight: bold;
    color: #1976D2;
    min-width: 40px;
    text-align: center;
}

.score-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
}

.inverse .score-item {
    background: #fff3e0;
}

.inverse .score-value {
    color: #f57c00;
}

.questions-list {
    padding: 1.5rem;
}

.normative-questions {
    padding-left: 1.5rem;
    margin: 1rem 0;
    counter-reset: question;
}

.normative-questions li {
    margin-bottom: 1rem;
    padding: 0.5rem 0;
    position: relative;
    transition: transform 0.2s ease;
}

.normative-questions li:hover {
    transform: translateX(5px);
}

.badge {
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    border-radius: 20px;
}

.alert {
    margin-bottom: 1.5rem;
    border-radius: 8px;
}

@media (max-width: 768px) {
    .scoring-system {
        padding: 0 1rem;
    }

    .scoring-grid {
        grid-template-columns: 1fr;
    }

    .score-item {
        padding: 0.75rem;
    }
}

/* Additional visual enhancements */
.score-item {
    border: 1px solid rgba(0,0,0,0.1);
}

.normative-questions li {
    border-bottom: 1px solid #eee;
}

.normative-questions li:last-child {
    border-bottom: none;
}

.alert i {
    font-size: 1.2rem;
}

/* SERVICES Section */

.services-section {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 2rem;
    font-family: Arial, sans-serif;
}

.services-container {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.services-header {
    text-align: center;
}

.services-header h3 {
    font-size: 2rem;
    color: #333;
    margin-bottom: 1.5rem;
}

.intro-text {
    font-size: 1.1rem;
    color: #666;
    max-width: 800px;
    margin: 0 auto 1.5rem;
    line-height: 1.6;
}

.approach-box {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 1.5rem;
    margin: 2rem auto;
    max-width: 800px;
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.approach-box i {
    font-size: 2rem;
}

.services-grid {
    display: flex;
    flex-wrap: nowrap;
    gap: 1.5rem;
    margin: 2rem 0;
    overflow-x: auto;
    padding: 1rem 0.5rem;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
}

.service-card {
    flex: 0 0 280px; /* Fixed width for each card */
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

/* Add custom scrollbar styling */
.services-grid::-webkit-scrollbar {
    height: 8px;
}

.services-grid::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.services-grid::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

.services-grid::-webkit-scrollbar-thumb:hover {
    background: #666;
}

/* Add gradient indicators for scroll */
.services-container {
    position: relative;
}

.services-container::before,
.services-container::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    width: 50px;
    z-index: 1;
    pointer-events: none;
}

.services-container::before {
    left: 0;
    background: linear-gradient(to right, rgba(255,255,255,1), rgba(255,255,255,0));
}

.services-container::after {
    right: 0;
    background: linear-gradient(to left, rgba(255,255,255,1), rgba(255,255,255,0));
}

/* Adjust service card content for better fit */


.service-card h4 {
    font-size: 1.1rem;
    margin-bottom: 0.8rem;
    min-height: 2.4em; /* Ensure consistent height for titles */
}

.amount {
    font-size: 1.3rem;
}

.price-note {
    font-size: 0.85rem;
    min-height: 2.5em; /* Ensure consistent height for notes */
}

/* Add scroll buttons for better UX */
.scroll-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: white;
    border: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    transition: all 0.3s ease;
}

.scroll-button:hover {
    background: #f8f9fa;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}

.scroll-left {
    left: -20px;
}

.scroll-right {
    right: -20px;
}

@media (max-width: 768px) {
    .scroll-button {
        display: none; /* Hide scroll buttons on mobile */
    }

    .services-grid {
        padding: 1rem 0;
    }

    .service-card {
        flex: 0 0 260px; /* Slightly smaller cards on mobile */
    }
}

/* Add gentle animation suggesting scrollability on mobile */
@media (max-width: 768px) {
    .services-grid {
        animation: gentle-bounce 2s infinite;
    }

    @keyframes gentle-bounce {
        0%, 100% { transform: translateX(0); }
        50% { transform: translateX(-10px); }
    }
}

.duration {
    color: #666;
}

.price-note {
    font-size: 0.9rem;
    color: #666;
    margin-top: 0.5rem;
}

.special {
    background: linear-gradient(135deg, #f8f9fa, #ffffff);
    border: 2px dashed #dee2e6;
}

.corporate-note {
    color: #666;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
}

.contact-section {
    margin-top: 2rem;
}

.contact-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
}

.contact-options {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-top: 1.5rem;
}

.contact-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #1976D2;
    text-decoration: none;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    transition: background-color 0.2s ease;
}

.contact-link:hover {
    background-color: #f8f9fa;
    text-decoration: none;
}

.expert-link {
    color: #1976D2;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    background: #e3f2fd;
    transition: background-color 0.2s ease;
}

.expert-link:hover {
    background: #bbdefb;
    text-decoration: none;
}

@media (max-width: 768px) {
    .services-section {
        padding: 0 1rem;
    }

    .services-grid {
        grid-template-columns: 1fr;
    }

    .contact-options {
        flex-direction: column;
        gap: 1rem;
    }
}

.action-btn {
    transition: all 0.3s ease;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 12px 24px;
    margin-bottom: 1rem;
    width: 100%;
    border: none;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.action-btn:active {
    transform: translateY(0);
}

.action-btn i {
    font-size: 1.2em;
}

.calculate-btn {
    background: linear-gradient(45deg, #2196F3, #1976D2);
    color: white;
}

.export-btn {
    background: linear-gradient(45deg, #4CAF50, #388E3C);
    color: white;
}

.share-btn {
    background: linear-gradient(45deg, #1877f2, #166fe5);
    color: white;
}

.restart-btn {
    background: linear-gradient(45deg, #9E9E9E, #757575);
    color: white;
}

.btn-loading {
    position: relative;
    color: transparent !important;
}

.btn-loading:after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    top: 50%;
    left: 50%;
    margin: -10px 0 0 -10px;
    border: 3px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.scores-interpretation-section {
    font-family: Arial, sans-serif;
}

.card {
    transition: transform 0.2s ease-in-out;
}

.card:hover {
    transform: translateY(-5px);
}

.rounded-circle {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.table {
    font-size: 0.9rem;
}

@media (max-width: 768px) {
    .display-4 {
        font-size: 2.5rem;
    }

    .card-title {
        font-size: 1.1rem;
    }

    .table {
        font-size: 0.8rem;
    }
}

.expert-quote {
    position: relative;
    padding: 1rem;
    border-left: 4px solid #0d6efd;
    background-color: #f8f9fa;
}

.list-group-item {
    border: none;
    padding: 0.5rem 1rem;
    background-color: transparent;
}

.alert {
    border-radius: 1rem;
}

.badge {
    font-size: 1.2rem;
    padding: 0.5rem 1rem;
}

/* Interpretation section */

.interpretation-section {
    padding: 2rem 0;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
}

.subscale-card {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: transform 0.3s ease;
    height: 100%;
}

.subscale-card:hover {
    transform: translateY(-5px);
}

.subscale-card h3 {
    font-size: 1.2rem;
    font-weight: 600;
    color: #333;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
}

.subtitle {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.feature-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.feature-list li {
    display: flex;
    align-items: flex-start;
    margin-bottom: 1rem;
    gap: 0.75rem;
}

.feature-list li i {
    margin-top: 0.25rem;
    width: 20px;
}

.feature-list li strong {
    color: #333;
    display: block;
    margin-bottom: 0.25rem;
}

.text-purple {
    color: #9C27B0;
}

@media (max-width: 768px) {
    .subscale-card {
        margin-bottom: 1rem;
    }
}

/* Validity section */

.validity-section {
    padding: 4rem 0;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
}

.validity-card {
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 15px rgba(0,0,0,0.05);
}

.validity-metrics .table {
    margin-bottom: 0;
}

.validity-metrics th {
    background: #f8f9fa;
    font-weight: 600;
}

.key-findings li {
    padding: 1rem;
    border-color: rgba(0,0,0,0.1);
}

.sensitivity-explanation .card {
    border: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

@media (max-width: 768px) {
    .validity-section {
        padding: 2rem 0;
    }

    .table-responsive {
        margin: 0 -1rem;
    }
}

/* QUESTIONS */
.question {
    margin-bottom: 2rem;
    padding: 1.5rem;
    border-radius: 12px;
    background-color: white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    border: 2px solid transparent;
    transition: all 0.3s ease;
}

.question:hover,
.question:focus-within {
    border-color: #2196F3;
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
}

.question-text {
    font-size: 1.2rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    color: #2c3e50;
    font-weight: 500;
    padding: 0.8rem;
    border-radius: 8px;
    background-color: #f8f9fa;
}

/* Enhanced form check styles */
.form-check {
    margin-bottom: 1rem;
    padding: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    min-height: 3.5rem;
}

.form-check:hover {
    background-color: #f5f9ff;
    border-color: #90caf9;
}

/* Larger radio buttons */
.form-check-input {
    width: 24px;
    height: 24px;
    margin-right: 12px;
    cursor: pointer;
}

/* Enhanced label text */
.form-check-label {
    font-size: 1.1rem;
    padding: 0.5rem;
    color: #455a64;
    cursor: pointer;
    user-select: none;
    flex: 1;
}

/* Focus styles */
.form-check:focus-within {
    outline: 3px solid #2196F3;
    outline-offset: 2px;
}

/* Help button and content */
.help-button {
    color: #666;
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.help-button:hover {
    color: #2196F3;
}

.help-content {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 8px;
    background-color: #f8f9fa;
}

/* Screen reader only class */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Mobile optimizations */
@media (max-width: 768px) {
    .form-check {
        padding: 1.2rem;
        margin-bottom: 1.2rem;
    }

    .form-check-input {
        width: 28px;
        height: 28px;
    }

    .form-check-label {
        font-size: 1.2rem;
    }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .question {
        border: 3px solid #000;
    }

    .question-text {
        color: #000;
        background: #fff;
        border: 2px solid #000;
    }

    .form-check {
        border: 2px solid #000;
    }
}

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
    .question,
    .form-check {
        transition: none;
    }
}

/* HELP BUTTONS */
/* Help button and content styles */
.help-button {
    color: #666;
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s ease;
    border: none;
    background: none;
    border-radius: 4px;
}

.help-button:hover {
    color: #2196F3;
    background-color: rgba(33, 150, 243, 0.1);
}

.help-button:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.5);
}

.help-button[aria-expanded="true"] {
    color: #2196F3;
}

.help-content {
    max-height: 0;
    overflow: hidden;
    transition: all 0.3s ease-out;
    opacity: 0;
    margin-top: 0;
}

.help-content:not([hidden]) {
    max-height: 200px;
    opacity: 1;
    margin-top: 1rem;
}

.help-content .alert {
    margin-bottom: 0;
    background-color: #e3f2fd;
    border-color: #90caf9;
    color: #0d47a1;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .help-button,
    .help-content {
        transition: none;
    }
}

/* High contrast mode */
@media (prefers-contrast: high) {
    .help-button {
        border: 1px solid currentColor;
    }

    .help-button[aria-expanded="true"] {
        background: #000;
        color: #fff;
    }

    .help-content .alert {
        border: 2px solid #000;
        background: #fff;
        color: #000;
    }
}

.progress-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background: white;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    padding: 1rem;
    transform: translateY(-100%);
    transition: transform 0.3s ease;
    pointer-events: none;
    visibility: hidden;
}

.progress-container.visible {
    transform: translateY(0);
    pointer-events: auto;
    visibility: visible;
}

/* Needed to prevent content jump */
.test-actual-container {
    position: relative;
    scroll-margin-top: 120px; /* Adjust based on your progress bar height */
}

.progress-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.progress-bar {
    width: 100%;
    height: 12px;
    background: #f0f0f0;
    border-radius: 6px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #2196F3, #64B5F6);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-message {
    text-align: center;
    margin-top: 0.5rem;
    color: #333;
    font-weight: 500;
    transition: all 0.3s ease;
    animation: messagePopIn 0.5s ease;
}

.progress-message.updating {
    animation: messageUpdate 0.3s ease;
}

@keyframes messagePopIn {
    from {
        opacity: 0;
        transform: translateY(5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes messageUpdate {
    0% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.5;
        transform: scale(0.98);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

.question {
    margin-bottom: 2rem;
    padding: 1.5rem;
    border-radius: 8px;
    border-left: 3px solid transparent;
    transition: all 0.3s ease;
}

.question.current {
    border-left-color: #2196F3;
    background-color: #f8f9fa;
}

.question.completed::after {
    content: '✓';
    color: #4CAF50;
    position: absolute;
    right: 1rem;
    top: 1rem;
}
</style>

</head>
<body>
<div class="container">
    <div class="initial-section justify-content-center">
        <h1 class="text-center mt-4 mb-3" style="font-size: 1.5rem; font-weight: bold;">Test de screening autism la adulți - RAADS-R (Scala Ritvo pentru Autism / Asperger Revizuită)</h1>
        <p>
            Această versiune revizuită a <strong>Scalei Ritvo Autism Asperger Diagnostic (RAADS-R)</strong> este un <strong>instrument orientativ, dar extrem de precis</strong> pentru screening-ul <strong>trăsăturilor autiste la adulți</strong>. Întrebările au fost restructurate pe baza feedback-ului comunității autiste și al profesioniștilor, precum <strong>Dr. Natalie Engelbrecht</strong>. Testul constă în <strong>80 de afirmații</strong> pentru a ajuta la screening-ul autismului la adulții care pot „scăpa de sub radarul diagnostic”, din cauza unei <strong>prezentări aparent subclinice.</strong>
        </p>
        <div class="cta-button-wrapper">
            <div class="cta-emphasis">
                <a id="start-test" href="#first-disclaimer" class="cta-button pulse">
                    <i class="fas fa-clipboard-list"></i>
                    Mergi direct la Testul RAADS-R
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
        <b>Website realizat cu sprijinul:</b>
        <div class="partner-logos">
            <div class="container">
                <div class="row justify-content-center align-items-center g-4">
                    <div class="col-12 col-md-4">
                        <a href="https://www.ovidiuplaton.com" target="_blank" class="d-block text-center">
                            <img src="https://www.ovidiuplaton.com/content/images/2024/07/ovidiu-platon---consilier-autism-adhd--audhd.png"
                                 class="img-fluid"
                                 style="max-width: 275px;"
                                 alt="Ovidiu Platon - Consilier Parental si de Dezvoltare Personala - autism ADHD"/>
                        </a>
                    </div>
                    <div class="col-12 col-md-4">
                        <a href="https://www.suntautist.ro" target="_blank" class="d-block text-center">
                            <img src="https://www.doctoradhd.com/wp-content/uploads/2023/08/suntautist-logo-1024x385.png"
                                 class="img-fluid"
                                 style="max-width: 275px; max-height: 82px;"
                                 alt="Asociatia Sunt Autist - Autismul explicat de autisti"/>
                        </a>
                    </div>
                    <div class="col-12 col-md-4">
                        <a href="https://www.despreadhd.ro" target="_blank" class="d-block text-center">
                            <img src="https://www.despreadhd.ro/content/images/2024/10/despreadhd-ro.jpg"
                                 class="img-fluid"
                                 style="max-width: 275px; max-height: 82px;"
                                 alt="About ADHD România - Știință, diagnostic, tratament, suport"/>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-2">
            <b>Grupuri de suport:</b>
            <i class="fa-brands fa-facebook"></i> <a href="https://fb.com/groups/suntautist" target="_blank" rel="nofollow">
                Autismul explicat de autiști
            </a>
            &nbsp;|&nbsp;
            <i class="fa-brands fa-facebook"></i> <a href="https://fb.com/groups/aboutadhd" target="_blank" rel="nofollow">
                About ADHD România - Informații științifice, diagnostic, tratament
            </a>
        </div>
        <hr>
    </div>
        <!--RAADS-R explanations-->
    <div class="features-container">
        <div class="row g-4">
            <!-- Privacy Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-user-secret text-primary fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Confidențialitate</h3>
                    <p class="feature-text">
                        <div class="privacy-features">
                            <div class="privacy-item">
                                <i class="fas fa-check-circle text-success me-2"></i>
                                Test fără înregistrare necesară
                            </div>
                            <div class="privacy-item">
                                <i class="fas fa-lock text-warning me-2"></i>
                                Datele tale rămân CONFIDENȚIALE
                            </div>
                            <div class="privacy-item">
                                <i class="fas fa-store-slash text-danger me-2"></i>
                                NU stocăm informații personale. NU utilizăm cookies.
                            </div>
                            <div class="privacy-item">
                                <i class="fas fa-brands fa-github text-warning me-2"></i>
                                Cod sursă transparent și disponibil GRATUIT pe <a style="display: inline;" href="https://github.com/hodorogandrei/testautism" target="_blank">Github</a>
                            </div>
                        </div>
                    </p>
                </div>
            </div>

            <!-- Facebook Share Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fab fa-facebook text-primary fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Share pe Facebook</h3>
                    <p class="feature-text">
                        Împărtășește cu mândrie descoperirile tale! Dă share la scorul tău dacă ai aflat că ai putea fi autist! 🌟
                        <br><br>
                        <span class="feature-note">
                            <i class="fas fa-info-circle text-info me-1"></i>
                            Opțiune disponibilă după finalizarea testului. Imaginile partajate sunt generate pe server și stocate doar <b>temporar</b> pentru a putea fi partajate către Facebook. Acestea NU sunt legate în vreun fel de identitatea ta personală.
                        </span>
                    </p>
                </div>
            </div>

            <!-- PDF Export Feature -->
            <div class="col-12 col-md-4">
                <div class="feature-card h-100">
                    <div class="feature-icon">
                        <i class="fas fa-file-pdf text-danger fa-3x"></i>
                    </div>
                    <h3 class="feature-title">Export în PDF</h3>
                    <p class="feature-text">
                        Descarcă și păstrează scorul total, subscorurile, și răspunsurile la întrebări. Poți genera un PDF cu toate acestea, marcat cu data efectuării testului, pentru a-l revizui ulterior sau discuta cu profesioniștii calificați.
                        <br><br>
                        <span class="feature-note">
                            <i class="fas fa-info-circle text-info me-1"></i>
                            Opțiune disponibilă după finalizarea testului.
                            <i class="fas fa-laptop text-success me-1"></i> PDF-urile sunt generate <b>local</b>, pe dispozitivul tău. <i class="fas fa-shield-alt text-warning me-1"></i>. <b>NU</b> stocăm PDF-urile generate.
                        </span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="test-details-container">
        <!-- General Characteristics -->
        <div class="info-section">
            <div class="section-header">
                <i class="fas fa-info-circle text-primary me-2"></i>
                <h3>Caracteristici generale</h3>
            </div>

            <div class="version-cards">
                <!-- RAADS-R Version -->
                <div class="version-card">
                    <div class="version-title">
                        <i class="fas fa-star text-warning me-2"></i>
                        RAADS-R (RAADS revizuit)
                    </div>
                    <ul class="feature-list">
                        <li>
                            <i class="fas fa-list text-primary"></i>
                            <span><strong>Număr de afirmații:</strong> 80</span>
                        </li>
                        <li>
                            <i class="fas fa-clock text-success"></i>
                            <span><strong>Durată estimată:</strong> 10 – 30 de minute</span>
                        </li>
                        <li>
                            <i class="fas fa-tools text-info"></i>
                            <span><strong>Tip:</strong> Instrument de screening</span>
                        </li>
                        <li>
                            <i class="fas fa-users text-purple"></i>
                            <span><strong>Autori:</strong>Riva Ariella Ritvo, Ph.D. and Edward Ritvo, M.D. et al.</span>
                        </li>
                        <li>
                            <i class="fas fa-calendar-alt text-danger"></i>
                            <span><strong>Anul publicării:</strong> 2011</span>
                        </li>
                    </ul>
                    <div class="citation-box">
                        <i class="fas fa-book text-muted me-2"></i>
                        <strong>Lucrare seminală:</strong> <em>Ritvo, R. A., et al. (2011). The Ritvo Autism Asperger Diagnostic Scale-Revised (RAADS-R): a scale to assist the diagnosis of autism spectrum disorder in adults: an international validation study.</em>
                        <a href="https://doi.org/10.1007/s10803-010-1133-5" target="_blank" class="doi-link">
                            <i class="fas fa-external-link-alt"></i> Link DOI către studiul original
                        </a>
                    </div>
                </div>

                <!-- Original RAADS -->
                <div class="version-card">
                    <div class="version-title">
                        <i class="fas fa-history text-info me-2"></i>
                        RAADS Original
                    </div>
                    <ul class="feature-list">
                        <li>
                            <i class="fas fa-list text-primary"></i>
                            <span><strong>Număr de afirmații:</strong> 78</span>
                        </li>
                        <li>
                            <i class="fas fa-clock text-success"></i>
                            <span><strong>Durată estimată:</strong> 10 – 30 de minute</span>
                        </li>
                        <li>
                            <i class="fas fa-tools text-info"></i>
                            <span><strong>Tip:</strong> Instrument de screening</span>
                        </li>
                        <li>
                            <i class="fas fa-users text-purple"></i>
                            <span><strong>Autori:</strong>Riva Ariella Ritvo, Ph.D. and Edward Ritvo, M.D. et al.</span>
                        </li>
                        <li>
                            <i class="fas fa-calendar-alt text-danger"></i>
                            <span><strong>Anul publicării:</strong> 2008</span>
                        </li>
                    </ul>
                    <div class="citation-box">
                        <i class="fas fa-book text-muted me-2"></i>
                        <strong>Lucrare seminală:</strong> <em>Ritvo, R. A., et al. (2008). A scale to assist the diagnosis of autism and Asperger's disorder in adults (RAADS): A pilot study.</em>
                        <a href="https://doi.org/10.1007/s10803-007-0380-6" target="_blank" class="doi-link">
                            <i class="fas fa-external-link-alt"></i> Link DOI către studiul original
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Target Audience -->
        <div class="info-card">
            <div class="card-header">
                <i class="fas fa-users text-success me-2"></i>
                <h3>Cui îi este destinat testul?</h3>
            </div>
            <ul class="target-list">
                <li>
                    <i class="fas fa-user-check"></i>
                    <span><strong>Adulți (vârsta 16+)</strong> cu <strong>ASD nivel 1</strong> sau <strong>autism subclinic</strong></span>
                </li>
                <li>
                    <i class="fas fa-brain"></i>
                    <span><strong>Adulți</strong> cu <strong>IQ în intervalul de referință</strong> (IQ >=80)</span>
                </li>
            </ul>
        </div>

        <!-- Availability -->
        <div class="info-card">
            <div class="card-header">
                <i class="fas fa-globe text-info me-2"></i>
                <h3>Versiuni, disponibilitate și traduceri</h3>
            </div>
            <div class="availability-content">
                <p>RAADS-R a fost tradus în limba suedeză și în majoritatea limbilor prin intermediul translatorilor. Totuși, testele RAADS-R online <b><i>NU</i></b> par să abunde.</p>
                <p class="highlight-text">În prezent, suntem (probabil) singurii care găzduiesc RAADS-R online în 🇷🇴 limba română.</p>
            </div>
        </div>

        <!-- Test Process -->
        <div class="info-card">
            <div class="card-header">
                <i class="fas fa-tasks text-warning me-2"></i>
                <h3>Desfășurarea testului</h3>
            </div>
            <div class="process-content">
                <p>RAADS-R este un instrument de <strong>auto-raportare</strong>, conceput pentru a fi completat de către dumneavoastră. Un <strong>profesionist medical / clinician calificat</strong> poate oferi asistență în interpretarea itemilor dacă aveți dificultăți.</p>

                <div class="answer-options">
                    <h4><i class="fas fa-check-circle text-success me-2"></i>Opțiuni de răspuns:</h4>
                    <ol>
                        <li>Adevărat acum și când eram mic(ă)</li>
                        <li>Adevărat doar acum</li>
                        <li>Adevărat doar când aveam sub 16 ani</li>
                        <li>Niciodată adevărat</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="test-actual-container">
        <!-- Disclaimer -->
        <div id="first-disclaimer" class="alert alert-warning alert-dismissible fade show mb-4" role="alert">
            <h4 class="alert-heading">Disclaimer</h4>
            <p>
                Acest test este destinat <b>EXCLUSIV</b> în scop informativ și <b>NU</b> trebuie utilizat ca un instrument de diagnostic. Deși testul a fost adaptat pentru a răspunde nevoilor persoanelor autiste, el <b>NU</b> înlocuiește o evaluare profesională efectuată de un profesionist calificat în domeniul sănătății mintale sau un profesionist medical calificat.</p>

            <p>Pentru evaluări profesionale, vă recomandăm să vizitați <a href="https://www.doctoradhd.com/" target="_blank">doctoradhd.com</a>.</p>
            <p>
                Vă încurajăm să folosiți rezultatele în mod <strong>responsabil</strong> și să căutați <b>suport profesional calificat, de specialitate</b> dacă aveți nevoie de o evaluare detaliată.
            </p>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <!-- Disclaimer end -->
        <h2 class="text-center mb-4"><b>Scala Ritvo pentru Autism / Asperger Revizuită</b></h2>
        <div class="card mb-4">
            <div class="card-body">
                <p class="card-text">Acest test constă în 80 de afirmații pentru a asista în screening-ul autismului la adulți. Selectează răspunsul care se potrivește cel mai bine cu tine.</p>
            </div>
        </div>

        <div id="test">
            <form id="raadsrForm" class="mb-4">
                <div id="error" class="alert alert-danger" style="display: none;"></div>
                <!-- Questions will be injected here -->
            </form>

            <div class="modal fade" id="restartWarningModal" tabindex="-1" aria-labelledby="restartWarningModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="restartWarningModalLabel">Confirmare restart test</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p class="text-danger mb-3">
                                <strong>Atenție!</strong> Sunteți pe cale să începeți un test nou.
                            </p>
                            <p>
                                Toate răspunsurile și scorul actual vor fi șterse. Vă recomandăm să exportați mai întâi rezultatele ca PDF
                                dacă doriți să le păstrați.
                            </p>
                            <p class="mb-0">
                                Doriți să continuați?
                            </p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulează</button>
                            <button type="button" class="btn btn-danger" id="confirmRestartBtn">Da, începe un test nou</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="errorBelow" class="alert alert-danger" style="display: none;"></div>

            <button type="button" id="submitBtn" class="btn btn-primary btn-lg w-100 mb-4 action-btn calculate-btn">
                <i class="fas fa-calculator"></i>
                Calculează Scorul
            </button>

            <div id="result" class="alert alert-success" style="display:none;"></div>

            <button type="button" id="shareBtn" class="btn btn-primary btn-lg w-100 mb-4 action-btn share-btn" style="display:none; background-color: #1877f2;">
                <i class="fab fa-facebook me-2"></i>
                Distribuie pe Facebook
            </button>

            <button type="button" id="exportBtn" class="btn btn-success btn-lg w-100 mb-4 action-btn export-btn" style="display:none">
                <i class="fas fa-file-pdf"></i>
                Exportă ca PDF
            </button>

            <button type="button" id="restartBtn" class="btn btn-secondary btn-lg w-100 mb-4 action-btn restart-btn" style="display:none">
                <i class="fas fa-redo-alt"></i>
                Începe un nou test
            </button>
        </div>

    </div>
    <div class="scores-interpretation-section my-5">
        <div class="container">
            <!-- Main Title Section -->
            <div class="text-center mb-5">
                <h2 class="display-5 fw-bold mb-4">Ce înseamnă scorul meu?</h2>
                <p class="lead">
                    Toate scorurile de <span class="badge bg-primary">65</span> sau mai mari indică trăsături autiste.
                    Cu cât scorul este mai mare, cu atât aveți mai multe trăsături autiste.
                </p>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Rețineți că niciun test nu este concludent și că nu toate persoanele autiste obțin neapărat scoruri peste pragul definit la fiecare test. Acest test este destinat <b>EXCLUSIV</b> în scop informativ și <b>NU</b> trebuie utilizat ca un instrument de diagnostic. Deși testul a fost adaptat pentru a răspunde nevoilor persoanelor autiste, el <b>NU</b> înlocuiește o evaluare profesională efectuată de un profesionist calificat în domeniul sănătății mintale sau un profesionist medical calificat. Pentru evaluări profesionale, vă recomandăm să vizitați <a href="https://www.doctoradhd.com/" target="_blank">doctoradhd.com</a>.
                </div>
            </div>

            <!-- Validity Section -->
            <div class="row g-4">
                <div class="col-12">
                    <h3 class="fw-bold mb-1">Validitate RAADS-R</h3>
                </div>
                <div class="col-12">
                    <b></b>Următoarele date sunt preluate din cadrul:</b>
                    <div class="citation-box">
                        <i class="fas fa-book text-muted me-2"></i>
                        <strong>Lucrare / studiu seminal:</strong>
                        <em>Ritvo, R. A., et al. (2011). The Ritvo Autism Asperger Diagnostic Scale-Revised (RAADS-R): a scale to assist the diagnosis of autism spectrum disorder in adults: an international validation study.</em>
                        <a href="https://doi.org/10.1007/s10803-010-1133-5" target="_blank" class="doi-link">
                            <i class="fas fa-external-link-alt"></i> Link DOI către studiul original
                        </a>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="display-4 text-primary mb-3">97% *</div>
                            <h5 class="card-title">Sensibilitate</h5>
                            <p class="card-text">Capacitatea testului de a identifica rezultate pozitive</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="display-4 text-success mb-3">100% *</div>
                            <h5 class="card-title">Specificitate</h5>
                            <p class="card-text">Capacitatea testului de a identifica rezultate negative</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="display-4 text-warning mb-3">96% *</div>
                            <h5 class="card-title">Validitate concurentă</h5>
                            <p class="card-text">Validitatea comparată cu ADOS Module 4, SRS</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <div class="display-4 text-info mb-3">0.987 *</div>
                            <h5 class="card-title">Fiabilitate test-retest</h5>
                            <p class="card-text">Concordanța între rezultatele măsurătorilor succesive</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="validity-section">
        <div class="container">
            <div class="validity-card">
                <div class="card">
                    <div class="card-header bg-white">
                        <h2 class="mb-0"><i class="fas fa-check-circle text-success me-2"></i>Sensibilitate și specificitate</h2>
                    </div>
                    <div class="card-body">
                        <p class="lead">RAADS-R este un instrument fiabil pentru a ajuta la diagnosticarea adulților autiști *.</p>

                        <div class="key-findings">
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <i class="fas fa-check text-success me-2"></i>
                                    Niciun neurotipic care a susținut testul nu a obținut un scor peste pragul autismului.
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-check text-success me-2"></i>
                                    Doar 3% din grupul de autiști nu au obținut un scor peste 65.
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-check text-success me-2"></i>
                                    Fiabilitatea test-retest a fost ridicată, în special pentru grupul de autiști *.
                                </li>
                            </ul>
                        </div>

                        <div class="sensitivity-explanation">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <p>O sensibilitate de 97% înseamnă că 97% dintre persoanele autiste care au efectuat testul au atins scorul limită și au fost clasificate cu exactitate ca autiste. Altfel spus, reprezintă proporția de autiști care au fost clasificați corect ca autiști pe baza chestionarului.</p>
                                    <p>În schimb, un scor de specificitate de 100% înseamnă că toate persoanele neurotipice care au participat la test s-au situat sub scorul limită și au fost clasificate cu exactitate ca neautiste.</p>
                                    <div class="alert alert-success">
                                        <i class="fas fa-chart-line me-2"></i>
                                        <strong>Concluzie:</strong> Conform studiului seminal, testul RAADS-R are o probabilitate ridicată de a-i clasifica cu exactitate pe cei care participă la test ca autiști sau non-autiști.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="interpretation-section">
        <div class="container">
            <div class="row">
                <!-- Language Card -->
                <div class="col-md-3">
                    <div class="subscale-card h-100">
                        <h3><i class="fas fa-comments text-primary me-2"></i>Limbaj</h3>
                        <div class="card-content">
                            <p class="subtitle">7 afirmații care evaluează:</p>
                            <ul class="feature-list">
                                <li>
                                    <i class="fas fa-film text-info"></i>
                                    <span><strong>Vorbirea din filme:</strong> Prietenii observă că ai auzit ceva nou pentru că începi să folosești regulat cuvântul sau fraza.</span>
                                </li>
                                <li>
                                    <i class="fas fa-coffee text-warning"></i>
                                    <span><strong>Small talk:</strong> O conversație ușoară despre lucruri neimportante pe care oamenii o poartă în timpul interacțiunilor sociale—în loc de subiecte care sunt cu adevărat interesante și distractive.</span>
                                </li>
                                <li>
                                    <i class="fas fa-quote-right text-success"></i>
                                    <span><strong>A fi literal:</strong> Provocări când limbajul 'ce se spune' nu se potrivește cu limbajul 'ce se înțelege'.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Social Relatedness Card -->
                <div class="col-md-3">
                    <div class="subscale-card h-100">
                        <h3><i class="fas fa-users text-success me-2"></i>Relaționare socială</h3>
                        <div class="card-content">
                            <p class="subtitle">39 afirmații care evaluează:</p>
                            <ul class="feature-list">
                                <li>
                                    <i class="fas fa-brain text-purple"></i>
                                    <span><strong>Mentalizare:</strong> Provocări în înțelegerea gândurilor sau sentimentelor celorlalți.</span>
                                </li>
                                <li>
                                    <i class="fas fa-heart text-danger"></i>
                                    <span><strong>Interese comune:</strong> Preferința de a fi cu persoane cu care împărtășiți interese.</span>
                                </li>
                                <li>
                                    <i class="fas fa-fingerprint text-info"></i>
                                    <span><strong>A fi diferit:</strong> A fi considerat 'diferit'.</span>
                                </li>
                                <li>
                                    <i class="fas fa-comment-dots text-warning"></i>
                                    <span><strong>Directețe:</strong> A fi considerat nepoliticos; sau că ai pus întrebări jenante; sau ai arătat când alții au făcut o greșeală.</span>
                                </li>
                                <li>
                                    <i class="fas fa-exchange-alt text-success"></i>
                                    <span><strong>Reciprocitate dialectică:</strong> Provocări în a ști când este rândul tău să vorbești.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Sensory-Motor Card -->
                <div class="col-md-3">
                    <div class="subscale-card h-100">
                        <h3><i class="fas fa-hand-paper text-danger me-2"></i>Senzorial-motor</h3>
                        <div class="card-content">
                            <p class="subtitle">20 afirmații care evaluează:</p>
                            <ul class="feature-list">
                                <li>
                                    <i class="fas fa-volume-up text-warning"></i>
                                    <span><strong>Provocări cu volumul vocii:</strong> Vorbit foarte tare, nu suficient de tare, sau fluctuații semnificative între cele două.</span>
                                </li>
                                <li>
                                    <i class="fas fa-microphone text-info"></i>
                                    <span><strong>Diferențe de voce:</strong> Vorbire monotonă, ca un copil, sau în voci ciudate.</span>
                                </li>
                                <li>
                                    <i class="fas fa-running text-success"></i>
                                    <span><strong>Probleme de control motor:</strong> Stângăcie și lipsă de coordonare.</span>
                                </li>
                                <li>
                                    <i class="fas fa-eye text-purple"></i>
                                    <span><strong>Senzorial:</strong> Stimularea senzorială care nu deranjează pe alții poate fi dureroasă și copleșitoare.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Circumscribed Interests Card -->
                <div class="col-md-3">
                    <div class="subscale-card h-100">
                        <h3><i class="fas fa-bullseye text-warning me-2"></i>Interese circumscrise</h3>
                        <div class="card-content">
                            <p class="subtitle">14 afirmații care evaluează:</p>
                            <ul class="feature-list">
                                <li>
                                    <i class="fas fa-search-plus text-primary"></i>
                                    <span><strong>Preferință pentru detalii:</strong> focalizare pe detalii înainte de imaginea de ansamblu.</span>
                                </li>
                                <li>
                                    <i class="fas fa-exclamation-triangle text-danger"></i>
                                    <span><strong>Supărare la neprevăzut:</strong> O neplăcere când cineva îți schimbă rutina.</span>
                                </li>
                                <li>
                                    <i class="fas fa-star text-warning"></i>
                                    <span><strong>Interese speciale:</strong> Vorbitul despre ele, având-le...</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="scores-section">
        <!-- Score Significance Table -->
        <div class="score-card">
            <div class="card-header">
                <i class="fas fa-chart-line text-primary me-2"></i>
                <h3>Semnificația scorurilor RAADS-R</h3>
            </div>
            <div class="table-responsive">
                <table class="score-table significance-table">
                    <thead>
                        <tr>
                            <th width="120">Scor</th>
                            <th>Interpretare</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="score-value">25</td>
                            <td>Nu ești autist(ă).</td>
                        </tr>
                        <tr>
                            <td class="score-value">50</td>
                            <td>Ai unele trăsături autiste, dar probabil nu ești autist(ă).</td>
                        </tr>
                        <tr>
                            <td class="score-value">65</td>
                            <td>Scorul minim la care se consideră autism.</td>
                        </tr>
                        <tr>
                            <td class="score-value">90</td>
                            <td>Indicații mai puternice de autism, deși și non-autiștii pot obține scoruri atât de mari.</td>
                        </tr>
                        <tr>
                            <td class="score-value">130</td>
                            <td>Scorul mediu al persoanelor autiste; dovezi solide pentru autism.</td>
                        </tr>
                        <tr>
                            <td class="score-value">160</td>
                            <td>Dovezi foarte solide pentru autism.</td>
                        </tr>
                        <tr>
                            <td class="score-value">227</td>
                            <td>Scorul maxim obținut de o persoană autistă în studiul original.</td>
                        </tr>
                        <tr>
                            <td class="score-value">240</td>
                            <td>Scorul maxim posibil RAADS-R.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- RAADS-R Scores Table -->
        <div class="score-card">
            <div class="card-header">
                <i class="fas fa-table text-success me-2"></i>
                <h3>Praguri de scor RAADS-R</h3>
            </div>
            <div class="table-responsive">
                <table class="score-table thresholds-table">
                    <thead>
                        <tr>
                            <th>Construcție</th>
                            <th width="120">Scor prag</th>
                            <th width="120">Scor maxim</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Scor total</td>
                            <td class="threshold">65</td>
                            <td class="max-score">240</td>
                        </tr>
                        <tr>
                            <td>Limbaj</td>
                            <td class="threshold">4</td>
                            <td class="max-score">21</td>
                        </tr>
                        <tr>
                            <td>Relaționare socială</td>
                            <td class="threshold">31</td>
                            <td class="max-score">117</td>
                        </tr>
                        <tr>
                            <td>Senzorial-motor</td>
                            <td class="threshold">16</td>
                            <td class="max-score">60</td>
                        </tr>
                        <tr>
                            <td>Interese circumscrise</td>
                            <td class="threshold">15</td>
                            <td class="max-score">42</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="scoring-system">
        <div class="scoring-container">
            <!-- Regular Scoring -->
            <div class="scoring-card">
                <div class="card-header">
                    <i class="fas fa-calculator text-primary me-2"></i>
                    <h3>Scorarea Standard</h3>
                </div>
                <div class="scoring-grid">
                    <div class="score-item">
                        <div class="score-value">3</div>
                        <div class="score-label">
                            <i class="fas fa-check-circle text-success"></i>
                            Adevărat acum și când eram mic(ă)
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">2</div>
                        <div class="score-label">
                            <i class="fas fa-clock text-warning"></i>
                            Adevărat doar acum
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">1</div>
                        <div class="score-label">
                            <i class="fas fa-history text-info"></i>
                            Adevărat doar când aveam sub 16 ani
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">0</div>
                        <div class="score-label">
                            <i class="fas fa-times-circle text-danger"></i>
                            Niciodată adevărat
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inverse Scoring -->
            <div class="scoring-card inverse">
                <div class="card-header">
                    <i class="fas fa-sync-alt text-warning me-2"></i>
                    <h3>Scorare Inversă</h3>
                    <span class="badge bg-info ms-2">Pentru întrebările normative</span>
                </div>
                <div class="scoring-grid">
                    <div class="score-item">
                        <div class="score-value">0</div>
                        <div class="score-label">
                            <i class="fas fa-check-circle text-success"></i>
                            Adevărat acum și când eram mic(ă)
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">1</div>
                        <div class="score-label">
                            <i class="fas fa-clock text-warning"></i>
                            Adevărat doar acum
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">2</div>
                        <div class="score-label">
                            <i class="fas fa-history text-info"></i>
                            Adevărat doar când aveam sub 16 ani
                        </div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">3</div>
                        <div class="score-label">
                            <i class="fas fa-times-circle text-danger"></i>
                            Niciodată adevărat
                        </div>
                    </div>
                </div>
            </div>

            <!-- Normative Questions -->
            <div class="scoring-card questions">
                <div class="card-header">
                    <i class="fas fa-list-ol text-success me-2"></i>
                    <h3>Întrebări Normative cu Scorare Inversă</h3>
                    <span class="badge bg-primary ms-2">17 întrebări</span>
                </div>
                <div class="questions-list">
                    <div class="alert alert-info" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        Următoarele întrebări folosesc sistemul de scorare inversă prezentat mai sus.
                    </div>
                    <ol class="normative-questions">
                        <li>Exprim grijă și empatie, deși nu întotdeauna într-un mod tipic.</li>
                        <li>Îmi lipsesc prietenii apropiați sau familia când suntem despărțiți pentru mult timp, deși nu arăt mereu acest lucru.</li>
                        <li>Uneori spun lucruri direct fără intenția de a deranja pe cineva.</li>
                        <li>Recunosc când cineva apropiat are nevoie de consolare, deși poate că nu știu întotdeauna cum să reacționez.</li>
                        <li>Mă simt cel mai confortabil vorbind cu oameni care împărtășesc aceleași interese ca mine.</li>
                        <li>Vorba mea are un ritm și ton de voce considerat tipic de cei din jurul meu.</li>
                        <li>Îmi dau seama când cineva spune un lucru, dar vrea să însemne altceva.</li>
                        <li>Îmi place să discut lucruri importante sau să procesez lucrurile împreună cu prietenii.</li>
                        <li>Mă simt confortabil și încrezător(ă) în situațiile de întâlniri sau sociale cu alții.</li>
                        <li>Când oamenii îmi împărtășesc problemele lor personale, încerc să ofer sprijin cât pot de bine.</li>
                        <li>Oamenii îmi spun deseori că dau prea multe detalii atunci când explic ceva.</li>
                        <li>Mi se spune adesea că pun întrebări stânjenitoare sau incomode.</li>
                        <li>Am tendința să arăt greșelile altora, chiar dacă nu este necesar.</li>
                        <li>Îmi este dificil să recunosc când cineva flirtează cu mine sau îmi arată interes romantic.</li>
                        <li>Nu mă conectez ușor emoțional cu personajele din filme sau povești.</li>
                        <li>Mă simt cel mai confortabil vorbind despre subiecte care mă interesează profund.</li>
                        <li>Am fost descris(ă) ca fiind diferit(ă) sau neconvențional(ă).</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <div class="services-section">
        <div class="services-container">
            <!-- Header Section -->
            <div class="services-header">
                <h3>
                    <i class="fas fa-hands-helping text-primary me-2"></i>
                    Servicii de Consiliere și Coaching
                </h3>
                <p class="intro-text">
                    Pentru cei interesați de consiliere parentală și personală și coaching în neurodivergență concepute pentru o implicare pe termen lung,
                    <a href="https://www.ovidiuplaton.com" target="_blank" class="expert-link">
                        <i class="fas fa-user-tie"></i>
                        Ovidiu Platon
                    </a>
                    oferă o serie de servicii suplimentare pentru persoane, grupuri și corporații.
                </p>
                <div class="approach-box">
                    <i class="fas fa-lightbulb text-warning"></i>
                    <p>Aceste servicii se axează pe valorificarea puterii transformatoare a mișcării și a imaginilor vizuale pentru a te ajuta să te aliniezi la nevoile și aspirațiile tale unice.</p>
                </div>
            </div>

            <!-- Services Grid -->
            <div class="services-grid">
                <!-- Individual Counseling -->
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <h4>Consiliere Individuală</h4>
                    <div class="price">
                        <span class="amount">240 RON</span>
                        <span class="duration">/ 60 minute</span>
                    </div>
                    <div class="price-note">Începând de la</div>
                </div>

                <!-- Group Counseling -->
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h4>Consiliere de Grup</h4>
                    <div class="price">
                        <span class="amount">160 RON</span>
                        <span class="duration">/ ședință</span>
                    </div>
                </div>

                <!-- Parent Counseling -->
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h4>Consiliere pentru Părinți</h4>
                    <div class="price">
                        <span class="amount">240 RON</span>
                        <span class="duration">/ 60 minute</span>
                    </div>
                    <div class="price-note">Pentru părinții persoanelor neurodivergente</div>
                </div>

                <!-- Support Groups -->
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-hand-holding-heart"></i>
                    </div>
                    <h4>Grupuri de Sprijin</h4>
                    <div class="price">
                        <span class="amount">160 RON</span>
                        <span class="duration">/ ședință</span>
                    </div>
                </div>

                <!-- Corporate Services -->
                <div class="service-card special">
                    <div class="service-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <h4>Servicii Corporate</h4>
                    <div class="corporate-note">
                        <i class="fas fa-check-circle"></i>
                        Personalizate conform necesităților organizației
                    </div>
                </div>
            </div>

            <!-- Contact Section -->
            <div class="contact-section">
                <div class="contact-card">
                    <h4>
                        <i class="fas fa-info-circle text-primary me-2"></i>
                        Mai multe informații
                    </h4>
                    <p>Pentru o descriere completă a serviciilor și pentru a afla cum pot să te sprijin:</p>
                    <div class="contact-options">
                        <a href="https://www.ovidiuplaton.com/" target="_blank" class="contact-link">
                            <i class="fas fa-globe"></i>
                            ovidiuplaton.com
                        </a>
                        <a href="mailto:hello@ovidiuplaton.com" class="contact-link">
                            <i class="fas fa-envelope"></i>
                            hello@ovidiuplaton.com
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
const questions = [
    // 80 de întrebări ca obiecte cu text și flag pentru inversare
    // Indexarea începe de la 1 pentru claritate
    { id: 1, text: "Exprim grijă și empatie, deși nu întotdeauna într-un mod tipic.", inverse: true },
    { id: 2, text: "Repet adesea fraze din filme sau emisiuni TV în conversații pentru că mă ajută să mă exprim.", inverse: false },
    { id: 3, text: "Uneori nu-mi dau seama că vorbele sau acțiunile mele pot părea grosolane pentru ceilalți.", inverse: false },
    { id: 4, text: "Am dificultăți în a-mi regla volumul vocii, vorbind uneori prea tare sau prea încet.", inverse: false },
    { id: 5, text: "În situații sociale, de multe ori mă simt nesigur(ă) în legătură cu cum să mă comport.", inverse: false },
    { id: 6, text: "Pot să îmi imaginez perspectivele altora, deși poate necesita efort suplimentar pentru a înțelege sentimentele lor.", inverse: false },
    { id: 7, text: "Limbajul figurativ (ex. „ești mărul ochilor mei”) este dificil de înțeles pentru mine.", inverse: false },
    { id: 8, text: "Mă simt cel mai confortabil vorbind cu oameni care împărtășesc aceleași interese ca mine.", inverse: true },
    { id: 9, text: "Mă concentrez pe detalii mici înainte de a vedea imaginea de ansamblu.", inverse: false },
    { id: 10, text: "Textura mâncării în gură este mai importantă pentru mine decât gustul ei.", inverse: false },
    { id: 11, text: "Îmi lipsesc prietenii apropiați sau familia când suntem despărțiți pentru mult timp, deși nu arăt mereu acest lucru.", inverse: true },
    { id: 12, text: "Uneori spun lucruri direct fără intenția de a deranja pe cineva.", inverse: true },
    { id: 13, text: "Prefer să vorbesc despre subiecte specifice care mă interesează profund.", inverse: false },
    { id: 14, text: "Prefer deseori să petrec timp singur(ă), chiar și în locuri unde alții se așteaptă să socializez.", inverse: false },
    { id: 15, text: "Îmi este dificil să-mi imaginez cum ar fi să fiu altcineva sau să văd lucrurile din perspectiva lor.", inverse: false },
    { id: 16, text: "Oamenii mi-au spus că sunt stângaci(ă) sau neîndemânatic(ă).", inverse: false },
    { id: 17, text: "Am fost descris(ă) ca fiind diferit(ă) sau neconvențional(ă).", inverse: true },
    { id: 18, text: "Recunosc când cineva apropiat are nevoie de consolare, deși poate că nu știu întotdeauna cum să reacționez.", inverse: true },
    { id: 19, text: "Sunt foarte sensibil(ă) la cum simt hainele pe pielea mea.", inverse: false },
    { id: 20, text: "Uneori copiez comportamentele altora pentru a mă integra sau pentru a părea mai „normal(ă)”.", inverse: false },
    { id: 21, text: "A vorbi cu mai multe persoane în același timp poate fi copleșitor sau intimidant pentru mine.", inverse: false },
    { id: 22, text: "Simt deseori presiunea de a mă comporta așa cum se așteaptă ceilalți, chiar dacă nu este natural pentru mine.", inverse: false },
    { id: 23, text: "Întâlnirile cu oameni noi pot fi dificile sau stresante pentru mine.", inverse: false },
    { id: 24, text: "Mă simt confuz(ă) sau frustrat(ă) când oamenii mă întrerup atunci când sunt concentrat(ă) pe un subiect care mă pasionează.", inverse: false },
    { id: 25, text: "Îmi este greu să înțeleg emoțiile altor persoane în timpul conversațiilor.", inverse: false },
    { id: 26, text: "A lua parte la conversații de grup poate fi o provocare pentru mine.", inverse: false },
    { id: 27, text: "Am tendința de a lua lucrurile literal, ceea ce poate face să pierd subtilitățile unei conversații.", inverse: false },
    { id: 28, text: "Îmi este dificil să recunosc când cineva simte emoții precum jenă sau invidie.", inverse: false },
    { id: 29, text: "Anumite texturi care nu deranjează pe alții pot fi foarte inconfortabile pentru mine.", inverse: false },
    { id: 30, text: "Mă supăr când rutina mea este schimbată neașteptat.", inverse: false },
    { id: 31, text: "Nu am simțit niciodată nevoia de a fi într-o relație „intimă” așa cum o numesc alții.", inverse: false },
    { id: 32, text: "Îmi este greu să încep sau să opresc o conversație până nu simt că mi-am terminat gândurile.", inverse: false },
    { id: 33, text: "Vorbesc cu un ritm și ton de voce considerat tipic de cei din jurul meu.", inverse: true },
    { id: 34, text: "Același sunet, culoare sau textură mă poate afecta diferit la momente diferite.", inverse: false },
    { id: 35, text: "Unele expresii, cum ar fi „te am sub piele,” mă fac să mă simt inconfortabil sau sunt greu de înțeles.", inverse: false },
    { id: 36, text: "Anumite sunete, cum ar fi zgomotele înalte sau anumite cuvinte, pot fi dureroase fizic de auzit.", inverse: false },
    { id: 37, text: "Încerc să fiu înțelegător/înțelegătoare atunci când alții își împărtășesc sentimentele sau problemele personale cu mine.", inverse: true },
    { id: 38, text: "Nu mă conectez ușor emoțional cu personajele din filme sau povești.", inverse: true },
    { id: 39, text: "Îmi este dificil să recunosc când cineva flirtează cu mine sau îmi arată interes romantic.", inverse: true },
    { id: 40, text: "Pot vizualiza în mintea mea în detaliu lucrurile care mă interesează.", inverse: false },
    { id: 41, text: "Îmi place să păstrez liste sau colecții de fapte specifice, chiar dacă nu au o utilizare practică.", inverse: false },
    { id: 42, text: "Când sunt copleșit(ă) de stimuli senzoriali, am nevoie să mă izolez pentru a mă liniști.", inverse: false },
    { id: 43, text: "Îmi place să discut lucruri importante sau să procesez lucrurile împreună cu prietenii.", inverse: true },
    { id: 44, text: "Îmi este greu să îmi dau seama dacă cineva este interesat sau plictisit în timp ce vorbesc.", inverse: false },
    { id: 45, text: "Îmi este dificil să citesc limbajul corporal sau expresiile faciale ale altor persoane.", inverse: false },
    { id: 46, text: "Experiențele senzoriale precum atingerea sau temperatura pot să mă afecteze diferit în momente diferite.", inverse: false },
    { id: 47, text: "Mă simt confortabil și încrezător(ă) în situațiile de întâlniri sau sociale cu alții.", inverse: true },
    { id: 48, text: "Când oamenii îmi împărtășesc problemele lor personale, încerc să ofer sprijin cât pot de bine.", inverse: true },
    { id: 49, text: "Mi s-a spus că vocea mea este neobișnuită într-un fel (ex. monotonă, înaltă, copilăroasă).", inverse: false },
    { id: 50, text: "Uneori un anumit subiect sau gând rămâne blocat în mintea mea și simt nevoia să vorbesc despre el chiar dacă ceilalți nu sunt interesați.", inverse: false },
    { id: 51, text: "Fac deseori mișcări repetitive cu mâinile sau cu obiecte (ex. fluturare, învârtire, sau mișcarea obiectelor în fața ochilor mei).", inverse: false },
    { id: 52, text: "Nu găsesc majoritatea lucrurilor care îi interesează pe ceilalți foarte captivante.", inverse: false },
    { id: 53, text: "Sunt considerat(ă) o persoană compasională, deși pot arăta acest lucru în moduri diferite.", inverse: true },
    { id: 54, text: "Interacționez cu ceilalți urmând reguli sociale specifice pe care le-am învățat pentru a mă integra.", inverse: true },
    { id: 55, text: "Îmi este foarte dificil să lucrez și să funcționez în grupuri.", inverse: false },
    { id: 56, text: "Când cineva schimbă subiectul în timp ce vorbesc, mă simt derutat(ă) și confuz(ă).", inverse: false },
    { id: 57, text: "Uneori trebuie să îmi acopăr urechile pentru a bloca zgomotele copleșitoare (ex. vocile puternice, aspiratorul).", inverse: false },
    { id: 58, text: "Sunt capabil(ă) să port conversații lejere, deși poate necesita un efort suplimentar.", inverse: false },
    { id: 59, text: "Uneori lucruri care ar trebui să fie dureroase, cum ar fi rănile, nu par să provoace atâta durere.", inverse: false },
    { id: 60, text: "Când vorbesc cu cineva, îmi este adesea greu să îmi dau seama când este rândul meu să vorbesc sau să ascult.", inverse: false },
    { id: 61, text: "Sunt deseori văzut(ă) ca un „lup singuratic” de către cei care mă cunosc cel mai bine.", inverse: false },
    { id: 62, text: "Vorbesc de obicei cu un ton de voce pe care ceilalți îl consideră tipic.", inverse: true },
    { id: 63, text: "Prefer ca lucrurile să rămână la fel zi după zi și chiar și schimbările mici mă pot deranja.", inverse: false },
    { id: 64, text: "Găsesc că este dificil și confuz să îmi fac prieteni și să socializez.", inverse: false },
    { id: 65, text: "Mă liniștește să fac mișcări repetitive, cum ar fi învârtirea sau balansarea, când sunt stresat(ă).", inverse: false },
    { id: 66, text: "Expresii precum „își poartă inima pe mânecă” nu au sens pentru mine.", inverse: false },
    { id: 67, text: "Luminile puternice, mirosurile intense sau zgomotele puternice mă pot face să mă simt anxios/anxioasă sau copleșit(ă).", inverse: false },
    { id: 68, text: "Îmi dau seama când cineva spune un lucru, dar vrea să însemne altceva.", inverse: true },
    { id: 69, text: "Îmi place să petrec timp singur(ă) cât de mult pot.", inverse: false },
    { id: 70, text: "Îmi organizez gândurile într-un mod unic, cum ar fi să le stivuiesc în memoria mea pentru a le găsi mai târziu.", inverse: false },
    { id: 71, text: "Uneori același sunet poate părea foarte tare sau foarte încet, chiar dacă știu că nu s-a schimbat.", inverse: false },
    { id: 72, text: "Îmi place să petrec timp mâncând și vorbind cu familia și prietenii mei.", inverse: false },
    { id: 73, text: "Nu suport anumite senzații (ex. mirosuri, texturi, sunete) care nu par să deranjeze pe ceilalți.", inverse: false },
    { id: 74, text: "Nu îmi place să fiu îmbrățișat(ă) sau atins(ă) decât dacă am fost de acord cu asta.", inverse: false },
    { id: 75, text: "Când merg undeva, trebuie să urmez un traseu familiar, altfel mă pot confunda și supăra.", inverse: false },
    { id: 76, text: "Îmi este greu să înțeleg ce așteaptă oamenii de la mine în situațiile sociale.", inverse: false },
    { id: 77, text: "Îmi place să am prieteni apropiați, deși poate că nu știu întotdeauna cum să întrețin prieteniile.", inverse: false },
    { id: 78, text: "Oamenii îmi spun deseori că dau prea multe detalii atunci când explic ceva.", inverse: true },
    { id: 79, text: "Mi se spune adesea că pun întrebări stânjenitoare sau incomode.", inverse: false },
    { id: 80, text: "Am tendința să arăt greșelile altora, chiar dacă nu este necesar.", inverse: false }
];

// RAADS-R Categories according to the paper page 1083
const RAADS_R_CATEGORIES = {
    // Social Relatedness - 39 questions
    socialRelatedness: [1, 6, 8, 11, 14, 17, 18, 25, 37, 38, 3, 5, 12, 28, 39,
                       44, 45, 76, 79, 80, 20, 21, 22, 23, 26, 31, 43, 47, 48,
                       53, 54, 55, 60, 61, 64, 68, 69, 72, 77],

    // Language - 7 questions
    language: [2, 7, 27, 35, 58, 66, 15],

    // Sensory Motor - 20 questions
    sensoryMotor: [10, 19, 4, 33, 34, 36, 46, 71, 16, 29, 42, 49, 51, 57, 59,
                   62, 65, 67, 73, 74],

    // Circumscribed Interests - 14 questions
    circumscribedInterests: [9, 13, 24, 30, 32, 40, 41, 50, 52, 56, 63, 70, 75, 78]
};

// Score thresholds from Table 3, page 1079
const RAADS_R_THRESHOLDS = {
    socialRelatedness: 31,  // 96.0% sensitivity
    circumscribedInterests: 15, // 89.6% sensitivity
    sensoryMotor: 16, // 85.1% sensitivity
    language: 4, // 88.6% sensitivity
    total: 65  // 97% sensitivity, 100% specificity
};

// Normative questions that use inverse scoring (marked with * in paper)
const INVERSE_SCORING_QUESTIONS = [1, 6, 11, 18, 23, 26, 33, 37, 43, 47, 48, 53, 58, 62, 68, 72, 77];

// Maximum possible scores based on number of questions per category * 3 points
const MAX_SCORES = {
    language: 21,           // 7 questions * 3 points
    socialRelatedness: 117, // 39 questions * 3 points
    sensoryMotor: 60,      // 20 questions * 3 points
    circumscribedInterests: 42,  // 14 questions * 3 points
    total: 240             // 80 questions * 3 points
};

/**
 * Find questions that might be counted in multiple categories
 * This is a validation function to ensure proper category assignments
 */
function findDuplicateQuestionCounts() {
    const questionCounts = {};
    const duplicates = [];

    // Count occurrences of each question across categories
    Object.entries(RAADS_R_CATEGORIES).forEach(([category, questions]) => {
        questions.forEach(questionId => {
            if (!questionCounts[questionId]) {
                questionCounts[questionId] = [];
            }
            questionCounts[questionId].push(category);
        });
    });

    // Check for questions appearing in multiple categories
    Object.entries(questionCounts).forEach(([questionId, categories]) => {
        if (categories.length > 1) {
            duplicates.push({
                questionId: parseInt(questionId),
                categories: categories,
                message: `Question ${questionId} appears in multiple categories: ${categories.join(', ')}`
            });
        }
    });

    // Check for missing questions (1-80)
    const allQuestions = Object.values(RAADS_R_CATEGORIES).flat();
    const missingQuestions = [];
    for (let i = 1; i <= 80; i++) {
        if (!allQuestions.includes(i)) {
            missingQuestions.push(i);
        }
    }

    return {
        duplicates,
        missingQuestions,
        valid: duplicates.length === 0 && missingQuestions.length === 0
    };
}

/**
 * Calculate subscores and total score according to RAADS-R specifications
 * Based on scoring instructions from Appendix 2, page 1088
 */
function calculateSubscores() {
    // First validate category assignments
    const categoryValidation = findDuplicateQuestionCounts();
    if (!categoryValidation.valid) {
        console.warn('Category assignment issues detected:', categoryValidation);
    }

    // Initialize subscores
    const subscores = {
        language: 0,
        socialRelatedness: 0,
        sensoryMotor: 0,
        circumscribedInterests: 0
    };

    // Track scoring details for validation
    const scoringLog = [];

    // Calculate scores for each category
    Object.entries(RAADS_R_CATEGORIES).forEach(([category, questionIds]) => {
        questionIds.forEach(id => {
            const selected = document.querySelector(`input[name="question_${id}"]:checked`);
            if (selected) {
                let score = parseInt(selected.value);
                const isInverse = INVERSE_SCORING_QUESTIONS.includes(id);

                // Apply inverse scoring if needed
                if (isInverse) {
                    score = 3 - score;
                }

                subscores[category] += score;

                // Log scoring details
                scoringLog.push({
                    questionId: id,
                    category: category,
                    rawValue: parseInt(selected.value),
                    inverseScoring: isInverse,
                    finalScore: score
                });
            }
        });
    });

    // Calculate total score
    const totalScore = Object.values(subscores).reduce((sum, score) => sum + score, 0);

    // Validate scores against maximums
    Object.entries(subscores).forEach(([category, score]) => {
        if (score > MAX_SCORES[category]) {
            console.error(`Invalid score for ${category}: ${score} exceeds maximum possible ${MAX_SCORES[category]}`);
        }
    });

    if (totalScore > MAX_SCORES.total) {
        console.error(`Invalid total score: ${totalScore} exceeds maximum possible ${MAX_SCORES.total}`);
    }

    // Determine if scores meet diagnostic thresholds
    const diagnosticIndicators = {
        meetsThreshold: totalScore >= RAADS_R_THRESHOLDS.total,
        categoryThresholds: {
            socialRelatedness: subscores.socialRelatedness >= RAADS_R_THRESHOLDS.socialRelatedness,
            circumscribedInterests: subscores.circumscribedInterests >= RAADS_R_THRESHOLDS.circumscribedInterests,
            language: subscores.language >= RAADS_R_THRESHOLDS.language,
            sensoryMotor: subscores.sensoryMotor >= RAADS_R_THRESHOLDS.sensoryMotor
        }
    };

    return {
        subscores,
        totalScore,
        diagnosticIndicators,
        scoringLog,
        validation: {
            categoryAssignments: categoryValidation,
            scoresValid: totalScore <= MAX_SCORES.total &&
                        Object.entries(subscores).every(([cat, score]) => score <= MAX_SCORES[cat])
        }
    };
}

// Function to get interpretation based on official RAADS-R criteria
function getInterpretation(score) {
    if (score <= 65) {
        return 'Sub pragul pentru autism (scor < 65)';
    } else if (score <= 89) {
        return 'Posibil autism (scor între 65-89)';
    } else if (score <= 130) {
        return 'Probabil autism (scor între 90-130)';
    } else {
        return 'Foarte probabil autism (scor > 130)';
    }
}

// Function to get detailed category interpretation
function getCategoryInterpretation(category, score) {
    const threshold = RAADS_R_THRESHOLDS[category];
    if (score >= threshold) {
        return `Peste pragul diagnostic (${threshold})`;
    } else {
        return `Sub pragul diagnostic (${threshold})`;
    }
}

const form = document.getElementById('raadsrForm');
const resultDiv = document.getElementById('result');
const errorDiv = document.getElementById('error');
const errorBelowDiv = document.getElementById('errorBelow');
const submitBtn = document.getElementById('submitBtn');

// Buttons appearing after submit
const exportBtn = document.getElementById('exportBtn');
const restartBtn = document.getElementById('restartBtn');

// Start test button at the top
const startBtn = document.getElementById('start-test');

// Share button
const shareBtn = document.getElementById('shareBtn');

// Form generation with Bootstrap classes with enhanced accessibility
questions.forEach((question, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.classList.add('question', 'mb-4');
    questionDiv.setAttribute('role', 'group');
    questionDiv.setAttribute('aria-labelledby', `question-${question.id}-label`);
    questionDiv.setAttribute('data-question-number', question.id);

    // Question label container
    const questionLabel = document.createElement('div');
    questionLabel.id = `question-${question.id}-label`;
    questionLabel.classList.add('question-text');
    questionLabel.innerHTML = `${question.id}. ${question.text}`;

    // Add inverse scoring indicator for screen readers
    if (INVERSE_SCORING_QUESTIONS.includes(question.id)) {
        const inverseNote = document.createElement('span');
        inverseNote.classList.add('sr-only');
        inverseNote.innerHTML = ' (Întrebare cu scorare inversă)';
        questionLabel.appendChild(inverseNote);
    }

    questionDiv.appendChild(questionLabel);

    // Create fieldset for radio buttons
    const fieldset = document.createElement('fieldset');
    fieldset.classList.add('options');

    // Add legend for screen readers
    const legend = document.createElement('legend');
    legend.classList.add('sr-only');
    legend.innerHTML = `Opțiuni pentru <b>întrebarea ${question.id}</b>`;
    fieldset.appendChild(legend);

    const options = [
        {
            label: "Adevărat acum și când eram mic(ă)",
            value: "3",
            description: "Selectați dacă afirmația este adevărată atât în prezent cât și în trecut"
        },
        {
            label: "Adevărat doar acum",
            value: "2",
            description: "Selectați dacă afirmația este adevărată doar în prezent"
        },
        {
            label: "Adevărat doar când aveam sub 16 ani",
            value: "1",
            description: "Selectați dacă afirmația era adevărată doar în copilărie"
        },
        {
            label: "Niciodată adevărat",
            value: "0",
            description: "Selectați dacă afirmația nu a fost niciodată adevărată"
        }
    ];

    options.forEach((option, optionIndex) => {
        const label = document.createElement('label');
        label.classList.add('form-check');
        label.setAttribute('for', `q${question.id}-opt${optionIndex}`);

        const input = document.createElement('input');
        input.type = 'radio';
        input.id = `q${question.id}-opt${optionIndex}`;
        input.name = `question_${question.id}`;
        input.value = option.value;
        input.classList.add('form-check-input');
        input.setAttribute('aria-describedby', `q${question.id}-opt${optionIndex}-desc`);

        const span = document.createElement('span');
        span.classList.add('form-check-label');
        span.innerHTML = option.label;

        // Add description for screen readers
        const description = document.createElement('span');
        description.id = `q${question.id}-opt${optionIndex}-desc`;
        description.classList.add('sr-only');
        description.innerHTML = option.description;

        label.appendChild(input);
        label.appendChild(span);
        label.appendChild(description);
        fieldset.appendChild(label);
    });

    questionDiv.appendChild(fieldset);

    // Add help button
    const helpButton = document.createElement('button');
    helpButton.type = 'button';
    helpButton.classList.add('help-button', 'btn', 'btn-link', 'mt-2');
    helpButton.innerHTML = '<i class="fas fa-question-circle"></i> Ajutor pentru această întrebare';
    helpButton.setAttribute('aria-expanded', 'false');
    helpButton.setAttribute('aria-controls', `help-${question.id}`);

    const helpContent = document.createElement('div');
    helpContent.id = `help-${question.id}`;
    helpContent.classList.add('help-content');
    helpContent.setAttribute('hidden', '');
    helpContent.innerHTML = `
        <div class="alert alert-info mt-2">
            <p>Selectați opțiunea care descrie cel mai bine experiența dumneavoastră.</p>
            <p>Puteți naviga cu tastele săgeți sus/jos între opțiuni sau Tab între întrebări.</p>
        </div>
    `;

    questionDiv.appendChild(helpButton);
    questionDiv.appendChild(helpContent);

    form.appendChild(questionDiv);
});

// Function to create visual score component
const createScoreVisual = function (label, score, threshold, maxScore) {
    const { percentage, thresholdPercentage, color } = getScoreDetails(score, threshold, maxScore);

    return `
        <div class="score-component mb-4">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="score-label fw-bold">${label}</div>
                <div class="score-value">
                    <span class="current-score">${score}</span>
                    <span class="text-muted">/ ${maxScore}</span>
                </div>
            </div>
            <div class="progress" style="height: 20px; background-color: #e9ecef; position: relative;">
                <!-- Threshold marker -->
                <div class="threshold-marker" style="
                    position: absolute;
                    left: ${thresholdPercentage}%;
                    height: 100%;
                    width: 2px;
                    background-color: #000;
                    z-index: 2;
                "></div>
                <div class="progress-bar" role="progressbar"
                    style="width: ${percentage}%; background-color: ${color};"
                    aria-valuenow="${percentage}"
                    aria-valuemin="0"
                    aria-valuemax="100">
                </div>
            </div>
            <div class="d-flex justify-content-between mt-1">
                <small class="text-muted">0</small>
                <small class="text-muted fw-bold">Prag: ${threshold}</small>
                <small class="text-muted">${maxScore}</small>
            </div>
        </div>
    `;
}

// Helper function to calculate score percentage and get appropriate color
function getScoreDetails(score, threshold, maxScore) {
    const percentage = (score / maxScore) * 100;
    const thresholdPercentage = (threshold / maxScore) * 100;

    // Color selection based on score relative to threshold
    let color;
    if (score < threshold) {
        color = '#4CAF50'; // Green
    } else if (score < threshold * 1.5) {
        color = '#FFC107'; // Yellow
    } else {
        color = '#F44336'; // Red
    }

    return { percentage, thresholdPercentage, color };
}

// Add validation function to catch scoring issues
function validateScore(score, subscores) {
    let issues = [];

    // Check for exceeding maximum scores
    Object.entries(MAX_SCORES).forEach(([category, maxScore]) => {
        const currentScore = category === 'total' ? score : subscores[category];
        if (currentScore > maxScore) {
            issues.push(`${category}: ${currentScore} exceeds maximum possible score of ${maxScore}`);
        }
    });

    return {
        valid: issues.length === 0,
        issues: issues
    };
}

// Function to get interpretation based on score
function getInterpretation(score) {
    if (score <= 25) return 'Nu ești autist(ă).';
    if (score <= 50) return 'Ai unele trăsături autiste, dar probabil nu ești autist(ă).';
    if (score <= 65) return 'Scorul este aproape de pragul minim pentru autism.';
    if (score <= 90) return 'Indicații de autism, deși și non-autiștii pot obține scoruri atât de mari.';
    if (score <= 130) return 'Scor în intervalul mediu pentru persoanele autiste.';
    if (score <= 160) return 'Dovezi foarte solide pentru autism.';
    return 'Scor foarte ridicat, specific persoanelor autiste.';
}

const getProgressMessage = function(percentage, answered) {
    if (percentage === 0) {
        return '🚀 Hai să începem! Primul pas este cel mai important! 💫';
    }

    if (percentage <= 10) {
        return '🌟 Minunat început! Pas cu pas, vei reuși! 💪';
    }

    if (percentage <= 20) {
        return '🎯 Ai prins ritmul! Continui excelent! ⭐';
    }

    if (percentage <= 30) {
        return `🌈 Super progres! Ai completat deja ${answered} întrebări! 🎉`;
    }

    if (percentage <= 40) {
        return '💫 Te descurci extraordinar! Ești pe drumul cel bun! 🎈';
    }

    if (percentage <= 50) {
        return '🎊 WOW! Ai ajuns la jumătate! Ești fantastic(ă)! 🌟';
    }

    if (percentage <= 60) {
        return '⚡ Impresionant! Mai puțin de jumătate rămas! 🔥';
    }

    if (percentage <= 70) {
        return '🎯 Extraordinar! Continui să strălucești! ✨';
    }

    if (percentage <= 80) {
        return '🚀 Ești pe ultima sută de metri! Aproape acolo! 💫';
    }

    if (percentage <= 90) {
        return '🌟 Fantastic! Mai ai foarte puțin! Ești aproape gata! 🎉';
    }

    if (percentage < 100) {
        return '✨ Ultima porțiune! Câteva întrebări și ai terminat! 🎯';
    }

    // 100%
    return `
        🎉 FELICITĂRI! 🎉
        <br/>
        <span style="font-size: 0.9em">Ai completat tot testul! Ești minunat(ă)! 🌟</span>
        <br/>
        <span style="font-size: 0.85em; color: #666">Apasă pe butonul albastru <b>CALCULEAZĂ SCORUL</b> pentru rezultate! 🎯</span>
    `;
};

// Progress tracking function
function initProgressTracking() {
    // Create and insert progress bar
    const progressHtml = `
        <div class="progress-container">
            <div class="progress-stats">
                <span class="questions-completed"><b>0</b> din <b>${questions.length}</b> întrebări</span>
                <span class="time-estimate">Timp rămas estimat: <b>30 minute</b></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="progress-message">Hai să începem! Primul pas este cel mai important.</div>
        </div>
    `;
    document.body.insertAdjacentHTML('afterbegin', progressHtml);

    // Cache DOM elements
    const progressFill = document.querySelector('.progress-fill');
    const questionsCompleted = document.querySelector('.questions-completed');
    const timeEstimate = document.querySelector('.time-estimate');
    const progressMessage = document.querySelector('.progress-message');

    // Scroll monitoring for .test-actual-container
    const testContainer = document.querySelector('.test-actual-container');
    const progressContainer = document.querySelector('.progress-container');

    // Helper function to check if we're within the test section
    function isInTestSection() {
        if (!testContainer) return false;

        const testRect = testContainer.getBoundingClientRect();
        const testStart = testContainer.offsetTop;
        const testEnd = testStart + testContainer.offsetHeight;
        const currentScroll = window.scrollY;

        // Consider the section "active" when:
        // 1. We've scrolled past its start (accounting for progress bar height)
        // 2. We haven't scrolled past its end
        return currentScroll >= testStart && currentScroll <= testEnd;
    }

    // Simplified scroll handler - no direction checking
    function handleScroll() {
        if (isInTestSection()) {
            progressContainer.classList.add('visible');
        } else {
            progressContainer.classList.remove('visible');
        }
    }

    // Helper function to check if we're within the test section
    function isInTestSection() {
        if (!testContainer) return false;

        const testRect = testContainer.getBoundingClientRect();
        const testStart = testContainer.offsetTop;
        const testEnd = testStart + testContainer.offsetHeight;
        const currentScroll = window.scrollY;

        // Consider the section "active" when:
        // 1. We've scrolled past its start (accounting for progress bar height)
        // 2. We haven't scrolled past its end
        return currentScroll >= testStart && currentScroll <= testEnd;
    }

    // Simplified scroll handler - no direction checking
    function handleScroll() {
        if (isInTestSection()) {
            progressContainer.classList.add('visible');
        } else {
            progressContainer.classList.remove('visible');
        }
    }

    // Monitor scroll position
    window.addEventListener('scroll', handleScroll, { passive: true });

    // Initial check
    handleScroll();

    // Handle window resize
    window.addEventListener('resize', handleScroll, { passive: true });

    let lastScrollTop = 0;

    function isElementInViewport(el) {
        const rect = el.getBoundingClientRect();
        return (
            rect.top <= 0 &&
            rect.bottom >= 0
        );
    }

    // Monitor scroll position
    // window.addEventListener('scroll', () => {
    //     const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

    //     // Check if test container is in viewport
    //     if (testContainer) {
    //         const testRect = testContainer.getBoundingClientRect();
    //         const isTestVisible = testRect.top < window.innerHeight && testRect.bottom > 0;

    //         if (isTestVisible) {
    //             // Show progress bar when scrolling up or at top of test section
    //             if (scrollTop < lastScrollTop || scrollTop <= testContainer.offsetTop) {
    //                 progressContainer.classList.add('visible');
    //             } else {
    //                 // Hide when scrolling down
    //                 progressContainer.classList.remove('visible');
    //             }
    //         } else {
    //             // Hide when test section is not visible
    //             progressContainer.classList.remove('visible');
    //         }
    //     }

    //     lastScrollTop = scrollTop;
    // });

    // Update progress function
    function updateProgress() {
        const answered = document.querySelectorAll('input[type="radio"]:checked').length;
        const total = questions.length;
        const percentage = (answered / total) * 100;

        // Update progress bar
        progressFill.style.width = percentage + '%';

        // Update stats
        questionsCompleted.innerHTML = `<b>${answered}</b> din <b>${total}</b> întrebări`;

        // Update message with animation
        progressMessage.classList.add('updating');
        progressMessage.innerHTML = getProgressMessage(percentage, answered);

        // Remove animation class after it completes
        setTimeout(() => {
            progressMessage.classList.remove('updating');
        }, 300);

        // Update time estimate
        const remainingQuestions = total - answered;
        const estimatedMinutes = Math.max(Math.ceil(remainingQuestions * 0.375), 1);
        timeEstimate.innerHTML = `Timp rămas estimat: <b>${estimatedMinutes} minute</b>`;
    }

    // Enhanced radio button change handler
    form.addEventListener('change', (e) => {
        if (e.target.type === 'radio') {
            const currentQuestion = e.target.closest('.question');
            currentQuestion.classList.add('completed');

            updateProgress();

            // Find and scroll to next unanswered question
            const nextUnanswered = Array.from(document.querySelectorAll('.question:not(.completed)'))
                .find(q => !q.querySelector('input[type="radio"]:checked'));

            if (nextUnanswered) {
                const offset = document.querySelector('.progress-container').offsetHeight + 20;
                const targetPosition = nextUnanswered.getBoundingClientRect().top + window.pageYOffset - offset;

                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });

                // Update current question highlighting
                document.querySelectorAll('.question').forEach(q => q.classList.remove('current'));
                nextUnanswered.classList.add('current');
            }
        }
    });

    // Initialize progress
    updateProgress();

    return {
        update: handleScroll,  // Expose update function for external calls
        destroy: () => {
            window.removeEventListener('scroll', handleScroll);
            window.removeEventListener('resize', handleScroll);
        }
    };
}

function scrollToQuestion(questionElement) {
    const progressContainer = document.querySelector('.progress-container');
    const progressHeight = progressContainer.classList.contains('visible') ?
                          progressContainer.offsetHeight : 0;

    const targetPosition = questionElement.getBoundingClientRect().top +
                          window.pageYOffset -
                          progressHeight - 20; // Additional padding

    window.scrollTo({
        top: targetPosition,
        behavior: 'smooth'
    });
}

// Add intersection observer to monitor test section visibility
function initTestSectionObserver() {
    const progressContainer = document.querySelector('.progress-container');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // Only show progress bar if we're at the top of the test section
                if (window.scrollY <= entry.target.offsetTop) {
                    progressContainer.classList.add('visible');
                }
            } else {
                progressContainer.classList.remove('visible');
            }
        });
    }, {
        threshold: 0,
        rootMargin: '-50px 0px 0px 0px'  // Adjust based on your needs
    });

    const testContainer = document.querySelector('.test-actual-container');
    if (testContainer) {
        observer.observe(testContainer);
    }
}

// Initialize everything
function initProgressTracker() {
    initProgressTracking();
    initTestSectionObserver();
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initProgressTracking);
} else {
    initProgressTracker();
}

// Add email button next to the export button
const emailBtn = document.createElement('button');
emailBtn.id = 'emailBtn';
emailBtn.className = 'btn btn-primary btn-lg w-100 mb-4 action-btn';
emailBtn.style.display = 'none';
emailBtn.innerHTML = '<i class="fas fa-envelope"></i> Trimite pe Email';

// Insert email button after export button
exportBtn.parentNode.insertBefore(emailBtn, exportBtn.nextSibling);

// Submit button click handler
submitBtn.addEventListener('click', (e) => {
    e.preventDefault();

    // Reset error states
    errorDiv.style.display = 'none';
    errorBelowDiv.style.display = 'none';
    errorDiv.innerHTML = '';
    errorBelowDiv.innerHTML = '';

    // Clear previous highlights
    document.querySelectorAll('.highlight-unanswered').forEach(el => {
        el.classList.remove('highlight-unanswered');
    });

    // Find unanswered questions
    let unanswered = [];
    questions.forEach(question => {
        const selected = document.querySelector(`input[name="question_${question.id}"]:checked`);
        if (!selected) {
            unanswered.push(question.id);
            const questionDiv = document.querySelector(`input[name="question_${question.id}"]`)
                .closest('.question');
            questionDiv.classList.add('highlight-unanswered');
        }
    });

    // Handle unanswered questions
    if (unanswered.length > 0) {
        const errorMessage = `Te rog să răspunzi la toate întrebările. Întrebările fără răspuns: ${unanswered.join(', ')}`;
        errorDiv.innerHTML = errorMessage;
        errorBelowDiv.innerHTML = errorMessage;
        errorDiv.style.display = 'block';
        errorBelowDiv.style.display = 'block';
        resultDiv.style.display = 'none';

        // Find and scroll to first unanswered question
        const firstUnanswered = document.querySelector('.highlight-unanswered');
        if (firstUnanswered) {
            const progressContainer = document.querySelector('.progress-container');
            const offset = progressContainer ? progressContainer.offsetHeight + 20 : 20;

            window.scrollTo({
                top: firstUnanswered.getBoundingClientRect().top + window.pageYOffset - offset,
                behavior: 'smooth'
            });
        }
        return;
    }

    // Calculate scores
    const results = calculateSubscores(questions);
    const { subscores, totalScore, diagnosticIndicators } = results;
    const interpretation = getInterpretation(totalScore);

    // Create enhanced results HTML
    resultDiv.innerHTML = `
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white py-3">
                <h2 class="card-title text-center mb-0 fw-bold">Rezultate Test RAADS-R</h2>
            </div>
            <div class="card-body p-4">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="total-score-section text-center p-4 mb-4" style="background-color: #f8f9fa; border-radius: 8px;">
                            <h3 class="h4 mb-3">Scor Total</h3>
                            <div class="display-4 mb-2">${totalScore}</div>
                            <p class="mb-0 text-muted">${interpretation}</p>
                        </div>
                    </div>
                </div>

                <h4 class="mb-4 fw-bold">Scoruri pe categorii</h4>

                <!-- Visual score components -->
                ${createScoreVisual('Limbaj', subscores.language, RAADS_R_THRESHOLDS.language, 21)}
                ${createScoreVisual('Relaționare socială', subscores.socialRelatedness, RAADS_R_THRESHOLDS.socialRelatedness, 117)}
                ${createScoreVisual('Senzorial-motor', subscores.sensoryMotor, RAADS_R_THRESHOLDS.sensoryMotor, 60)}
                ${createScoreVisual('Interese circumscrise', subscores.circumscribedInterests, RAADS_R_THRESHOLDS.circumscribedInterests, 42)}

                <!-- Category Interpretations -->
                <div class="mt-4 pt-3 border-top">
                    <div class="category-interpretations">
                        <h5 class="mb-3">Interpretare pe categorii:</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2">Limbaj: ${getCategoryInterpretation('language', subscores.language)}</li>
                            <li class="mb-2">Relaționare socială: ${getCategoryInterpretation('socialRelatedness', subscores.socialRelatedness)}</li>
                            <li class="mb-2">Senzorial-motor: ${getCategoryInterpretation('sensoryMotor', subscores.sensoryMotor)}</li>
                            <li class="mb-2">Interese circumscrise: ${getCategoryInterpretation('circumscribedInterests', subscores.circumscribedInterests)}</li>
                        </ul>
                    </div>
                </div>

                <!-- Legend -->
                <div class="mt-4 pt-3 border-top">
                    <div class="d-flex align-items-center mb-3">
                        <div style="width: 12px; height: 12px; background-color: #4CAF50; border-radius: 50%; margin-right: 8px;"></div>
                        <small class="text-muted">Sub prag</small>

                        <div style="width: 12px; height: 12px; background-color: #FFC107; border-radius: 50%; margin: 0 8px 0 16px;"></div>
                        <small class="text-muted">Aproape de prag</small>

                        <div style="width: 12px; height: 12px; background-color: #F44336; border-radius: 50%; margin: 0 8px 0 16px;"></div>
                        <small class="text-muted">Peste prag</small>
                    </div>

                    <div class="alert alert-info mb-0">
                        <small>
                            <i class="fas fa-info-circle me-2"></i>
                            Liniile negre verticale indică pragurile pentru fiecare categorie.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    `;

    // Update UI state
    resultDiv.style.display = 'block';
    submitBtn.style.display = 'none';
    exportBtn.style.display = 'block';
    restartBtn.style.display = 'block';
    shareBtn.style.display = 'block';

    // Hide progress bar
    const progressContainer = document.querySelector('.progress-container');
    if (progressContainer) {
        // First remove 'visible' class with transition
        progressContainer.classList.remove('visible');

        // After transition, force hide
        setTimeout(() => {
            progressContainer.style.display = 'none';
        }, 300); // Match this with your CSS transition time
    }

    // Update the padding of test container to prevent layout jump
    const testContainer = document.querySelector('.test-actual-container');
    if (testContainer) {
        testContainer.style.paddingTop = '20px'; // Reset to default padding
    }

    // Disable all radio inputs
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.disabled = true;
    });

    emailBtn.style.display = 'block';

    // Scroll to results
    setTimeout(() => {
        const resultElement = document.getElementById('result');
        if (resultElement) {
            const headerOffset = 20;
            const elementPosition = resultElement.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
    }, 100);
});

// Email button click handler
emailBtn.addEventListener('click', function() {
    emailModal.show();
});

// Send email handler
document.getElementById('sendEmailBtn').addEventListener('click', async function() {
    const emailForm = document.getElementById('emailForm');
    const recipientEmail = document.getElementById('recipientEmail').value;
    const gdprConsent = document.getElementById('gdprConsent').checked;
    const sendEmailBtn = this;

    if (!gdprConsent) {
        return;
    }

    try {
        // Show loading state
        sendEmailBtn.disabled = true;
        sendEmailBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Se trimite...';

        // Generate PDF blob
        const results = calculateSubscores(questions);
        const pdf = await generatePDFBlob(); // We'll implement this function

        // Create FormData with PDF and email
        const formData = new FormData();
        formData.append('email', recipientEmail);
        formData.append('pdf', pdf, 'rezultate_test_raads_r.pdf');
        formData.append('score', results.totalScore.toString());
        formData.append('interpretation', getInterpretation(results.totalScore));

        // Send to backend
        const response = await fetch('/send-results-email.php', {
            method: 'POST',
            body: formData
        });

        if (!response.ok) {
            throw new Error('Eroare la trimiterea email-ului');
        }

        const result = await response.json();

        // Show success message
        emailModal.hide();
        alert('Email-ul a fost trimis cu succes!');

    } catch (error) {
        console.error('Error sending email:', error);
        alert('A apărut o eroare la trimiterea email-ului. Te rugăm să încerci din nou.');
    } finally {
        // Reset button state
        sendEmailBtn.disabled = false;
        sendEmailBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Trimite';
    }
});

startBtn.addEventListener('click', (e) => {
    e.preventDefault();

    // Smooth scroll to disclaimer section
    const disclaimerSection = document.getElementById('first-disclaimer');
    disclaimerSection.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
    });
});

// First add this helper function at the global scope
function formatScore(score) {
    return typeof score === 'number' && !isNaN(score) ? score : 0;
}

// exportBtn.addEventListener('click', () => {
//     // Create a temporary container
//     const container = document.createElement('div');
//     container.style.visibility = 'hidden';
//     container.style.position = 'absolute';
//     container.style.left = '-9999px';
//     document.body.appendChild(container);

//     // Calculate scores - use the proper structure from calculateSubscores
//     const { subscores, totalScore, diagnosticIndicators } = calculateSubscores(questions);

//     // Format all scores to ensure we have valid numbers
//     const formattedScores = {
//         language: formatScore(subscores.language),
//         socialRelatedness: formatScore(subscores.socialRelatedness),
//         sensoryMotor: formatScore(subscores.sensoryMotor),
//         circumscribedInterests: formatScore(subscores.circumscribedInterests)
//     };

//     const formattedTotalScore = formatScore(totalScore);
//     const interpretation = getInterpretation(formattedTotalScore);

//     // Create stylized content for PDF
//     const content = document.createElement('div');
//     content.style.cssText = `
//         font-family: Arial, sans-serif;
//         color: black;
//         font-size: 12px;
//         line-height: 1.4;
//         padding: 20px;
//         background: white;
//     `;

//     // Define score categories with their properties
//     const scoreCategories = {
//         'Limbaj': {
//             score: formattedScores.language,
//             threshold: RAADS_R_THRESHOLDS.language,
//             max: MAX_SCORES.language
//         },
//         'Relaționare socială': {
//             score: formattedScores.socialRelatedness,
//             threshold: RAADS_R_THRESHOLDS.socialRelatedness,
//             max: MAX_SCORES.socialRelatedness
//         },
//         'Senzorial-motor': {
//             score: formattedScores.sensoryMotor,
//             threshold: RAADS_R_THRESHOLDS.sensoryMotor,
//             max: MAX_SCORES.sensoryMotor
//         },
//         'Interese circumscrise': {
//             score: formattedScores.circumscribedInterests,
//             threshold: RAADS_R_THRESHOLDS.circumscribedInterests,
//             max: MAX_SCORES.circumscribedInterests
//         }
//     };

//     // Create the content HTML
//     content.innerHTML = `
//         <h1 style="font-size: 24px; text-align: center; margin-bottom: 20px;">Rezultate Test RAADS-R</h1>
//         <div style="text-align: center; padding: 20px; background-color: #f8f9fa; margin-bottom: 30px;">
//             <h2 style="font-size: 20px; margin-bottom: 10px;">Scor Total: ${formattedTotalScore}</h2>
//             <p style="color: #666;">${interpretation}</p>
//         </div>

//         <h3 style="font-size: 18px; margin-bottom: 20px;">Scoruri pe categorii:</h3>

//         <!-- Visual score components styled for PDF -->
//         ${Object.entries(scoreCategories).map(([category, scores]) => {
//             const percentage = Math.min(Math.max((scores.score / scores.max) * 100, 0), 100);
//             const color = scores.score < scores.threshold ? '#4CAF50' :
//                          scores.score < scores.threshold * 1.5 ? '#FFC107' : '#F44336';

//             return `
//                 <div style="margin-bottom: 25px;">
//                     <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
//                         <strong>${category}</strong>
//                         <span>${scores.score} / ${scores.max}</span>
//                     </div>
//                     <div style="width: 100%; height: 20px; background-color: #e9ecef; position: relative;">
//                         <div style="width: ${percentage}%; height: 100%; background-color: ${color};"></div>
//                         <div style="position: absolute; left: ${(scores.threshold/scores.max)*100}%; top: 0; height: 100%; width: 2px; background-color: black;"></div>
//                     </div>
//                     <div style="display: flex; justify-content: space-between; margin-top: 5px; color: #666;">
//                         <small>0</small>
//                         <small>Prag: ${scores.threshold}</small>
//                         <small>${scores.max}</small>
//                     </div>
//                 </div>
//             `;
//         }).join('')}

//         <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa;">
//             <strong>Legendă:</strong><br>
//             <span style="color: #4CAF50;">■</span> Sub prag &nbsp;&nbsp;
//             <span style="color: #FFC107;">■</span> Aproape de prag &nbsp;&nbsp;
//             <span style="color: #F44336;">■</span> Peste prag
//         </div>
//         <br/><br/>
//         <h3 style="font-size: 14px; font-weight: bold; margin-bottom: 15px;">Răspunsuri:</h3>
//     `;

//     // Add questions and answers
//     questions.forEach(question => {
//         const selected = document.querySelector(`input[name="question_${question.id}"]:checked`);
//         if (selected) {
//             const questionDiv = document.createElement('div');
//             questionDiv.style.cssText = 'margin-bottom: 15px; color: black;';

//             const questionText = document.createElement('p');
//             questionText.style.cssText = 'margin-bottom: 5px; font-weight: bold; color: black;';
//             questionText.innerHTML = `${question.id}. ${question.text}`;
//             questionDiv.appendChild(questionText);

//             const answerText = document.createElement('p');
//             answerText.style.cssText = 'margin-left: 15px; color: black;';
//             answerText.innerHTML = `Răspuns: ${selected.closest('label').innerHTML.trim()}`;
//             questionDiv.appendChild(answerText);

//             content.appendChild(questionDiv);
//         }
//     });

//     // Add date of test
//     const dateDiv = document.createElement('div');
//     dateDiv.style.cssText = 'margin-top: 20px; text-align: right; color: #666;';
//     dateDiv.innerHTML = `Data testului: ${new Date().toLocaleDateString('ro-RO')}`;
//     content.appendChild(dateDiv);

//     // Add the content to the container
//     container.appendChild(content);

//     // Configure html2pdf options
//     const opt = {
//         margin: [0.5, 0.5, 0.5, 0.5],
//         filename: 'rezultate_test_raads_r.pdf',
//         image: { type: 'jpeg', quality: 1 },
//         html2canvas: {
//             scale: 2,
//             useCORS: true,
//             logging: false,
//             letterRendering: false,
//             allowTaint: true,
//             backgroundColor: '#ffffff'
//         },
//         jsPDF: {
//             unit: 'in',
//             format: 'a4',
//             orientation: 'portrait',
//             putOnlyUsedFonts: true
//         },
//         pagebreak: { avoid: ['p', 'h1', 'h2', 'h3'] }
//     };

//     // Generate PDF
//     html2pdf()
//         .set(opt)
//         .from(content)
//         .save()
//         .then(() => {
//             // Clean up
//             document.body.removeChild(container);
//         })
//         .catch(error => {
//             console.error('PDF generation failed:', error);
//             document.body.removeChild(container);
//         });
// });

async function generatePDFBlob() {

    const results = calculateSubscores(questions);
    const { subscores, totalScore } = results;

    // Create container with A4 dimensions
    const container = document.createElement('div');
    container.style.cssText = `
        width: 595px; /* A4 width in points */
        background: white;
        position: fixed;
        left: 0;
        top: 0;
        padding: 40px;
        z-index: -9999;
        font-family: Arial, sans-serif;
        font-size: 11px;
        color: black;
        box-sizing: border-box;
    `;
    document.body.appendChild(container);

    const getScoreColor = (score, threshold) => {
        if (score < threshold) return '#4CAF50';
        if (score < threshold * 1.5) return '#FFC107';
        return '#F44336';
    };

    // Clean answer text function
    const cleanAnswerText = (text) => {
        // Remove the explanatory text in parentheses
        return text.split('(')[0].trim();
    };

    const contentHtml = `
        <div style="background: white; color: black; max-width: 515px;">
            <h1 style="font-size: 16px; text-align: center; margin-bottom: 12px; color: black;">
                Rezultate Test RAADS-R
            </h1>

            <div style="text-align: center; background-color: #f8f9fa; padding: 8px; margin: 12px 0; border-radius: 4px;">
                <span style="color: #666; font-size: 10px;">Rezultate generate de</span><br>
                <a href="https://www.testautism.ro" style="color: #2196F3; font-size: 12px; font-weight: bold;">
                    www.testautism.ro
                </a>
            </div>

            <div style="background-color: #fff3cd; border: 1px solid #ffeeba; padding: 10px; margin: 12px 0; border-radius: 4px;">
                <p style="color: #856404; margin: 0; font-size: 10px; line-height: 1.4;">
                    <strong>IMPORTANT:</strong> Acest test este destinat <strong>EXCLUSIV</strong> în scop informativ și
                    <strong>NU</strong> trebuie utilizat ca un instrument de diagnostic. Pentru evaluări profesionale,
                    vă recomandăm să vizitați <a href="https://www.doctoradhd.com" style="color: #856404; font-weight: bold;">www.doctoradhd.com</a>
                </p>
            </div>

            <div style="text-align: center; background-color: #f8f9fa; padding: 12px; margin: 12px 0; border-radius: 4px;">
                <h2 style="font-size: 14px; margin-bottom: 8px; color: black;">Scor Total: ${totalScore}</h2>
                <p style="color: #666; font-size: 11px; line-height: 1.4;">${getInterpretation(totalScore)}</p>
            </div>

            <h3 style="font-size: 13px; margin: 12px 0; color: black;">Scoruri pe categorii:</h3>

            <div style="margin-bottom: 20px;">
                ${Object.entries({
                    'Limbaj': { score: subscores.language, threshold: RAADS_R_THRESHOLDS.language, max: MAX_SCORES.language },
                    'Relaționare socială': { score: subscores.socialRelatedness, threshold: RAADS_R_THRESHOLDS.socialRelatedness, max: MAX_SCORES.socialRelatedness },
                    'Senzorial-motor': { score: subscores.sensoryMotor, threshold: RAADS_R_THRESHOLDS.sensoryMotor, max: MAX_SCORES.sensoryMotor },
                    'Interese circumscrise': { score: subscores.circumscribedInterests, threshold: RAADS_R_THRESHOLDS.circumscribedInterests, max: MAX_SCORES.circumscribedInterests }
                }).map(([category, data]) => {
                    const percentage = (data.score / data.max) * 100;
                    const color = getScoreColor(data.score, data.threshold);
                    return `
                        <div style="margin-bottom: 16px; background: white;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong style="color: black; font-size: 11px;">${category}</strong>
                                <span style="color: black; font-size: 11px;">${data.score} / ${data.max}</span>
                            </div>
                            <div style="position: relative; height: 16px; background-color: #e9ecef; border-radius: 3px; overflow: hidden;">
                                <div style="position: absolute; left: 0; top: 0; height: 100%; width: ${percentage}%; background-color: ${color};"></div>
                                <div style="position: absolute; left: ${(data.threshold/data.max)*100}%; top: 0; height: 100%; width: 2px; background-color: black;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 2px; font-size: 9px; color: #666;">
                                <span>0</span>
                                <span>Prag: ${data.threshold}</span>
                                <span>${data.max}</span>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>

            <div style="margin: 16px 0; padding: 10px; background-color: #f8f9fa; border-radius: 4px;">
                <strong style="color: black; font-size: 11px;">Legendă:</strong><br>
                <span style="color: #4CAF50;">■</span> Sub prag &nbsp;&nbsp;
                <span style="color: #FFC107;">■</span> Aproape de prag &nbsp;&nbsp;
                <span style="color: #F44336;">■</span> Peste prag
            </div>

            <div style="margin-top: 16px; text-align: right; color: #666; font-size: 9px;">
                Data testului: ${new Date().toLocaleDateString('ro-RO')}
            </div>
        </div>
    `;

    // Set container content
    container.innerHTML = contentHtml;

    var questionIndex = 0;
    // Add questions and answers
    questions.forEach(question => {
        const pageBreak = (questionIndex + 1) % 9 === 0 ? 'page-break-after: always;' : '';

        const selected = document.querySelector(`input[name="question_${question.id}"]:checked`);
        if (selected) {
            const questionDiv = document.createElement('div');
            questionDiv.style.cssText = 'margin-bottom: 30px; color: black; ${pageBreak}';

            const questionText = document.createElement('p');
            questionText.style.cssText = 'margin-bottom: 5px; font-weight: bold; color: black;';
            questionText.innerHTML = `${question.id}. ${question.text}`;
            questionDiv.appendChild(questionText);

            const answerText = document.createElement('p');
            answerText.style.cssText = 'margin-left: 15px; margin-bottom: 20px; color: black;';
            answerText.innerHTML = `Răspuns: ${selected.closest('label').querySelector('.form-check-label').innerHTML.trim()}`;
            questionDiv.appendChild(answerText);

            container.appendChild(questionDiv);
        }

        questionIndex++;
    });


    // Wait for content to be rendered
    await new Promise(resolve => setTimeout(resolve, 300));

    // PDF generation options
    const opt = {
        margin: [25, 20, 25, 20], // [top, right, bottom, left]
        filename: 'rezultate_test_raads_r.pdf',
        image: { type: 'jpeg', quality: 1 },
        html2canvas: {
            scale: 2,
            useCORS: true,
            allowTaint: true,
            backgroundColor: '#FFFFFF',
            width: 595,
            height: container.offsetHeight
        },
        jsPDF: {
            unit: 'pt',
            format: 'a4',
            orientation: 'portrait',
            putOnlyUsedFonts: true,
            compress: true
        },
        pagebreak: {
            mode: ['avoid-all', 'css', 'legacy']
        }
    };

    return await html2pdf().set(opt).from(container).outputPdf('blob');
}

exportBtn.addEventListener('click', async () => {
    exportBtn.disabled = true;
    exportBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Se generează PDF-ul...';

    try {
        // Generate PDF
        const pdf = await generatePDFBlob();
        const blobUrl = URL.createObjectURL(pdf);

        // Create download link
        const downloadLink = document.createElement('a');
        downloadLink.href = blobUrl;
        downloadLink.download = 'rezultate_test_raads_r.pdf';
        document.body.appendChild(downloadLink);

        // Handle Facebook in-app browser
        if (navigator.userAgent.match(/(FBAN|FBAV)/i)) {
            window.open(blobUrl, '_blank');
        } else {
            downloadLink.click();
        }

        // Cleanup
        setTimeout(() => {
            URL.revokeObjectURL(blobUrl);
            downloadLink.remove();
            container.remove();
        }, 1000);

    } catch (error) {
        console.error('PDF generation failed:', error);
        alert(`A apărut o eroare la generarea PDF-ului: ${error.message}\nTe rugăm să încerci din nou.`);
    } finally {
        exportBtn.disabled = false;
        exportBtn.innerHTML = '<i class="fas fa-file-pdf"></i> Exportă ca PDF';
    }
});

// Create modal for email input
const modalHtml = `
<div class="modal fade" id="emailModal" tabindex="-1" aria-labelledby="emailModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="emailModalLabel">Trimite rezultatele pe email</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="emailForm">
                    <div class="mb-3">
                        <label for="recipientEmail" class="form-label">Adresa de email</label>
                        <input type="email" class="form-control" id="recipientEmail" required
                               placeholder="exemplu@gmail.com">
                        <div class="form-text">Rezultatele vor fi trimise la această adresă.</div>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="gdprConsent" required>
                        <label class="form-check-label" for="gdprConsent">
                            Sunt de acord cu prelucrarea datelor mele personale în scopul trimiterii rezultatelor pe email.
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulează</button>
                <button type="button" class="btn btn-primary" id="sendEmailBtn">
                    <i class="fas fa-paper-plane"></i> Trimite
                </button>
            </div>
        </div>
    </div>
</div>
`;

// Add modal to body
document.body.insertAdjacentHTML('beforeend', modalHtml);

// Initialize modal
const emailModal = new bootstrap.Modal(document.getElementById('emailModal'));

// Restart button event listener
const restartWarningModal = new bootstrap.Modal(document.getElementById('restartWarningModal'));
const confirmRestartBtn = document.getElementById('confirmRestartBtn');

// Update the restartTest function to hide the share button
const restartTest = function() {
    // Reset progress container visibility
    const progressContainer = document.querySelector('.progress-container');

    if (progressContainer) {
        progressContainer.style.display = ''; // Remove inline display: none

        // Brief timeout to allow display to take effect before adding visible class
        setTimeout(() => {
            progressContainer.classList.add('visible');
        }, 10);
    }

    // Reset test container padding
    const testContainer = document.querySelector('.test-actual-container');
    if (testContainer) {
        testContainer.style.paddingTop = '120px'; // Reset to original padding
    }

    // Enable all radio inputs and uncheck them
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.disabled = false;
        radio.checked = false;
    });

    // Remove completion classes from questions
    document.querySelectorAll('.question').forEach(question => {
        question.classList.remove('completed');
        question.classList.remove('current');
    });

    // Hide results and action buttons
    resultDiv.style.display = 'none';
    exportBtn.style.display = 'none';
    restartBtn.style.display = 'none';
    shareBtn.style.display = 'none';

    // Show submit button
    submitBtn.style.display = 'block';

    // Remove any highlighting
    document.querySelectorAll('.highlight-unanswered').forEach(el => {
        el.classList.remove('highlight-unanswered');
    });

    // Hide the modal
    restartWarningModal.hide();

    // Reset progress if exists
    const progressFill = document.querySelector('.progress-fill');
    const questionsCompleted = document.querySelector('.questions-completed');
    const progressMessage = document.querySelector('.progress-message');
    if (progressFill) progressFill.style.width = '0%';
    if (questionsCompleted) questionsCompleted.innerHTML = `<b>0</b> din <b>${questions.length}</b> întrebări`;
    if (progressMessage) progressMessage.innerHTML = getProgressMessage(0, 0);

    // Find first question
    const firstQuestion = document.querySelector('.question');
    if (firstQuestion) {
        // Add current class to first question
        firstQuestion.classList.add('current');

        // Scroll to first question with offset for progress bar
        const offset = progressContainer ? progressContainer.offsetHeight + 20 : 20;

        setTimeout(() => {
            const targetPosition = firstQuestion.getBoundingClientRect().top +
                                 window.pageYOffset -
                                 offset;

            window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
            });

            initProgressTracker();
        }, 100); // Small delay to ensure DOM updates are complete
    }
};

// Update event listeners for the restart button and confirm button
restartBtn.addEventListener('click', (e) => {
    e.preventDefault();
    restartWarningModal.show();
});

confirmRestartBtn.addEventListener('click', restartTest);

// Re-attach change event listeners for radio buttons
function reInitializeRadioListeners() {
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
            const currentQuestion = e.target.closest('.question');
            currentQuestion.classList.add('completed');

            // Find next unanswered question
            const nextUnanswered = Array.from(document.querySelectorAll('.question:not(.completed)'))
                .find(q => !q.querySelector('input[type="radio"]:checked'));

            if (nextUnanswered) {
                // Remove current class from all questions
                document.querySelectorAll('.question').forEach(q => {
                    q.classList.remove('current');
                });

                // Add current class to next question
                nextUnanswered.classList.add('current');

                // Calculate scroll position
                const progressContainer = document.querySelector('.progress-container');
                const offset = progressContainer ? progressContainer.offsetHeight + 20 : 20;

                const targetPosition = nextUnanswered.getBoundingClientRect().top +
                                     window.pageYOffset -
                                     offset;

                // Smooth scroll to next question
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            }

            // Update progress if it exists
            if (typeof updateProgress === 'function') {
                updateProgress();
            }
        });
    });
}

// Call this when initializing the form and after restart
reInitializeRadioListeners();

// Restart button functionality
restartBtn.addEventListener('click', (e) => {
    e.preventDefault();

    restartWarningModal.show();
});

// Click handler for the confirm button in the modal
confirmRestartBtn.addEventListener('click', restartTest);

// Function to generate a random identifier
function generateUniqueId() {
    return 'raads_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
}

// Update the shareToFacebook function
async function shareToFacebook() {
    try {
        // Show loading state
        shareBtn.disabled = true;
        shareBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Se pregătește imaginea...';

        // Calculate scores using the proper RAADS-R scoring system
        const results = calculateSubscores(questions);

        // Format scores
        const formattedResults = {
            subscores: {
                language: Math.round(results.subscores.language) || 0,
                socialRelatedness: Math.round(results.subscores.socialRelatedness) || 0,
                sensoryMotor: Math.round(results.subscores.sensoryMotor) || 0,
                circumscribedInterests: Math.round(results.subscores.circumscribedInterests) || 0
            },
            totalScore: Math.round(results.totalScore) || 0
        };

        // Get interpretation based on total score
        const interpretation = getInterpretation(formattedResults.totalScore);

        // Get color for total score
        const totalScoreColor = formattedResults.totalScore < 65 ? '#4CAF50' :
                               formattedResults.totalScore < 90 ? '#FFC107' : '#F44336';

        // Create a visible container for html2canvas
        const container = document.createElement('div');
        container.style.cssText = `
            width: 1200px;
            height: 630px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: -9999;
            background: white;
        `;
        document.body.appendChild(container);

        // Define score categories
        const scoreCategories = [
            {
                name: 'Limbaj',
                score: formattedResults.subscores.language,
                max: MAX_SCORES.language,
                threshold: RAADS_R_THRESHOLDS.language
            },
            {
                name: 'Relaționare socială',
                score: formattedResults.subscores.socialRelatedness,
                max: MAX_SCORES.socialRelatedness,
                threshold: RAADS_R_THRESHOLDS.socialRelatedness
            },
            {
                name: 'Senzorial-motor',
                score: formattedResults.subscores.sensoryMotor,
                max: MAX_SCORES.sensoryMotor,
                threshold: RAADS_R_THRESHOLDS.sensoryMotor
            },
            {
                name: 'Interese circumscrise',
                score: formattedResults.subscores.circumscribedInterests,
                max: MAX_SCORES.circumscribedInterests,
                threshold: RAADS_R_THRESHOLDS.circumscribedInterests
            }
        ];

        // Create HTML content
        container.innerHTML = `
            <div style="width: 1200px; height: 630px; padding: 40px; box-sizing: border-box; font-family: Arial, sans-serif; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);">
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <h1 style="font-size: 42px; margin: 0; color: #333; letter-spacing: -0.5px;">
                        Rezultate Test RAADS-R
                    </h1>
                </div>

                <!-- Total Score -->
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 120px; font-weight: bold; color: ${totalScoreColor}; line-height: 1.2; margin: 20px 0;">
                        ${formattedResults.totalScore}
                    </div>
                    <div style="font-size: 28px; color: #666; margin-bottom: 20px;">
                        Scor Total
                    </div>
                    <div style="font-size: 32px; color: #333; max-width: 90%; margin: 0 auto 30px; line-height: 1.4;">
                        ${interpretation}
                    </div>
                </div>

                <!-- Score Categories -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 30px; padding: 0 40px;">
                    ${scoreCategories.map(category => {
                        const percentage = Math.min(Math.max((category.score / category.max) * 100, 0), 100);
                        const color = category.score < category.threshold ? '#4CAF50' :
                                    category.score < category.threshold * 1.5 ? '#FFC107' : '#F44336';

                        return `
                            <div style="text-align: center;">
                                <div style="font-size: 24px; color: #333; margin-bottom: 15px; font-weight: 500;">
                                    ${category.name}
                                </div>
                                <div style="position: relative; width: 100px; height: 100px; margin: 0 auto;">
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 20px; font-weight: bold;">
                                        ${category.score}/${category.max}
                                    </div>
                                    <svg width="100" height="100" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="45" fill="none" stroke="#e9ecef" stroke-width="6"/>
                                        <circle cx="50" cy="50" r="45" fill="none" stroke="${color}" stroke-width="6"
                                            stroke-dasharray="${percentage * 2.827}, 282.7"
                                            transform="rotate(-90 50 50)"/>
                                    </svg>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>

                <!-- CTA -->
                <div style="text-align: center; margin-top: 40px; font-size: 42px; font-weight: bold; color: ${totalScoreColor}; text-transform: uppercase; letter-spacing: 2px; background: linear-gradient(45deg, ${totalScoreColor}22, ${totalScoreColor}11); padding: 20px; border-radius: 12px;">
                    Fă și tu un test!
                </div>
            </div>
        `;

        // Wait a brief moment for rendering
        await new Promise(resolve => setTimeout(resolve, 100));

        // Generate image
        const canvas = await html2canvas(container, {
            width: 1200,
            height: 630,
            scale: 1,
            useCORS: true,
            allowTaint: true,
            backgroundColor: '#ffffff'
        });

        // Remove the container
        document.body.removeChild(container);

        // Convert canvas to blob
        const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg', 0.95));

        // Create FormData
        const formData = new FormData();
        const uniqueId = generateUniqueId();
        formData.append('image', blob, uniqueId + '.jpg');
        formData.append('id', uniqueId);
        formData.append('score', formattedResults.totalScore.toString());
        formData.append('subscores', JSON.stringify(formattedResults.subscores));
        formData.append('interpretation', interpretation);

        // Upload and share
        const response = await fetch('/save-result-image.php', {
            method: 'POST',
            body: formData
        });

        if (!response.ok) {
            throw new Error('Upload failed');
        }

        const data = await response.json();

        // Open Facebook share dialog
        const fbShareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(data.shareUrl)}`;
        window.open(
            fbShareUrl,
            'facebook-share-dialog',
            'width=626,height=436,top=' + (window.innerHeight - 436) / 2 + ',left=' + (window.innerWidth - 626) / 2
        );

    } catch (error) {
        console.error('Error sharing:', error);
        alert('A apărut o eroare la distribuirea rezultatelor. Vă rugăm să încercați din nou.');
    } finally {
        shareBtn.disabled = false;
        shareBtn.innerHTML = '<i class="fab fa-facebook me-2"></i>Distribuie pe Facebook';
    }
}

// Update the createSharingImage function
function createSharingImage(subscores, totalScore, interpretation, totalScoreColor) {
    console.log('Creating sharing image with:', {
        subscores,
        totalScore,
        interpretation,
        totalScoreColor
    });

    // Define score categories with their maximums
    const scoreCategories = [
        {
            name: 'Limbaj',
            score: Math.round(subscores.language),
            max: MAX_SCORES.language,
            threshold: RAADS_R_THRESHOLDS.language
        },
        {
            name: 'Relaționare socială',
            score: Math.round(subscores.socialRelatedness),
            max: MAX_SCORES.socialRelatedness,
            threshold: RAADS_R_THRESHOLDS.socialRelatedness
        },
        {
            name: 'Senzorial-motor',
            score: Math.round(subscores.sensoryMotor),
            max: MAX_SCORES.sensoryMotor,
            threshold: RAADS_R_THRESHOLDS.sensoryMotor
        },
        {
            name: 'Interese circumscrise',
            score: Math.round(subscores.circumscribedInterests),
            max: MAX_SCORES.circumscribedInterests,
            threshold: RAADS_R_THRESHOLDS.circumscribedInterests
        }
    ];

    const container = document.createElement('div');
    container.style.cssText = `
        width: 1200px;
        height: 630px;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        position: absolute;
        left: -9999px;
        top: -9999px;
        font-family: Arial, sans-serif;
        box-sizing: border-box;
        overflow: hidden;
    `;

    // Helper function to create arc progress indicator
    function createArcProgress(category) {
        const score = category.score;
        const max = category.max;
        const threshold = category.threshold;

        const percentage = Math.min(Math.max((score / max) * 100, 0), 100);
        const color = score < threshold ? '#4CAF50' :
                     score < threshold * 1.5 ? '#FFC107' : '#F44336';

        return `
            <div style="position: relative; width: 100px; height: 100px; margin: 0 auto;">
                <svg width="100" height="100" viewBox="0 0 100 100">
                    <!-- Background arc -->
                    <path d="M50 10 A40 40 0 0 1 90 50" fill="none"
                        stroke="#e9ecef" stroke-width="6" stroke-linecap="round"/>
                    <!-- Progress arc -->
                    <path d="M50 10 A40 40 0 ${percentage > 50 ? '1' : '0'} 1 ${
                        50 + 40 * Math.cos((percentage * 3.6 - 90) * Math.PI / 180)} ${
                        50 + 40 * Math.sin((percentage * 3.6 - 90) * Math.PI / 180)
                    }" fill="none"
                        stroke="${color}" stroke-width="6" stroke-linecap="round"/>
                    <!-- Score text -->
                    <text x="50" y="55" text-anchor="middle"
                        font-size="20" font-weight="bold" fill="#333">
                        ${score}/${max}
                    </text>
                </svg>
            </div>
        `;
    }

    container.innerHTML = `
        <div style="height: 100%; width: 100%; padding: 40px; box-sizing: border-box;">
            <div style="text-align: center; margin-bottom: 20px;">
                <h1 style="
                    font-size: 42px;
                    margin: 0;
                    color: #333;
                    letter-spacing: -0.5px;
                ">Rezultate Test RAADS-R</h1>
            </div>

            <!-- Total Score Section -->
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="
                    font-size: 120px;
                    font-weight: bold;
                    color: ${totalScoreColor};
                    line-height: 1.2;
                    margin: 20px 0;
                ">${Math.round(totalScore)}</div>
                <div style="
                    font-size: 28px;
                    color: #666;
                    margin-bottom: 20px;
                ">Scor Total</div>
                <div style="
                    font-size: 32px;
                    color: #333;
                    max-width: 90%;
                    margin: 0 auto 30px;
                    line-height: 1.4;
                    word-spacing: 4px;
                    letter-spacing: 0.2px;
                    white-space: normal;
                    text-align: center;
                ">${interpretation}</div>
            </div>

            <!-- Subscores Grid -->
            <div style="
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 30px;
                padding: 0 40px;
            ">
                ${scoreCategories.map(category => `
                    <div style="text-align: center;">
                        <div style="font-size: 24px; color: #333; margin-bottom: 15px; font-weight: 500;">
                            ${category.name}
                        </div>
                        ${createArcProgress(category)}
                    </div>
                `).join('')}
            </div>

            <!-- Call to Action -->
            <div style="
                text-align: center;
                margin-top: 10px;
                font-size: 42px;
                font-weight: bold;
                color: ${totalScoreColor};
                text-transform: uppercase;
                letter-spacing: 2px;
                background: linear-gradient(45deg, ${totalScoreColor}22, ${totalScoreColor}11);
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            ">
                Fă și tu un test!
            </div>
        </div>
    `;

    return container;
}

// Click handler for share button
shareBtn.addEventListener('click', shareToFacebook);


// ACCESSIBILITY FEATURES

// Add keyboard navigation
document.addEventListener('keydown', (e) => {
    const activeElement = document.activeElement;
    if (activeElement.type === 'radio') {
        const currentQuestion = activeElement.closest('.question');
        const radios = Array.from(currentQuestion.querySelectorAll('input[type="radio"]'));
        const currentIndex = radios.indexOf(activeElement);

        switch(e.key) {
            case 'ArrowDown':
            case 'ArrowRight':
                e.preventDefault();
                const nextIndex = (currentIndex + 1) % radios.length;
                radios[nextIndex].focus();
                break;
            case 'ArrowUp':
            case 'ArrowLeft':
                e.preventDefault();
                const prevIndex = (currentIndex - 1 + radios.length) % radios.length;
                radios[prevIndex].focus();
                break;
            case 'Home':
                e.preventDefault();
                radios[0].focus();
                break;
            case 'End':
                e.preventDefault();
                radios[radios.length - 1].focus();
                break;
        }
    }
});

// Add help button functionality
document.addEventListener('click', (e) => {
    if (e.target.closest('.help-button')) {
        const button = e.target.closest('.help-button');
        const helpContent = button.nextElementSibling;
        const isExpanded = button.getAttribute('aria-expanded') === 'true';

        // Toggle the help content
        button.setAttribute('aria-expanded', !isExpanded);
        helpContent.hidden = isExpanded;

        // Add animation class
        if (!isExpanded) {
            helpContent.classList.add('help-content-show');
        } else {
            helpContent.classList.remove('help-content-show');
        }

        // Announce to screen readers
        const announcement = document.createElement('div');
        announcement.setAttribute('role', 'status');
        announcement.setAttribute('aria-live', 'polite');
        announcement.classList.add('sr-only');
        announcement.innerHTML = `Ajutor pentru întrebare ${isExpanded ? 'închis' : 'deschis'}`;
        document.body.appendChild(announcement);
        setTimeout(() => announcement.remove(), 1000);
    }
});
</script>
</body>
</html>